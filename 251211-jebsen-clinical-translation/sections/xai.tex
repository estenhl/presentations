\section{The black-box problem of artificial intelligence}

\begin{frame}{Understanding artificial neural networks}
    \begin{tikzpicture}
        \node[draw=black] at (-7, -3.25) {};
        \node[draw=black] at (7, 3.25) {};

        \only<1-3,8-10>{
            \def\vsep{0.5}
            \def\hsep{0.65}
            \def\edgeopacity{0.5}

            \node[fill=gray!80, minimum width=4.5cm, minimum height=3.1cm, rounded corners=0.1cm, text=white, draw=black, font=\small, anchor=south, text depth=2.6cm] (model) at (0, -0.2) {
                Artificial neural network
            };

            \neuron[alt=<10>{fill=red!25!black}{fill=babagreen!60}]{n00}{($ (model.south) + (0, 1.25) + (-2*\hsep, -2*\vsep+0.1) $)}
            \neuron[alt=<10>{fill=red!90!black}{fill=babagreen!40}]{n01}{($ (n00) + (0, \vsep) $)}
            \neuron[alt=<10>{fill=yellow!15!red}{fill=babagreen!70!yellow}]{n02}{($ (n00) + (0, 2*\vsep) $)}
            \neuron[alt=<10>{fill=red!99!black}{fill=babagreen!40!yellow}]{n03}{($ (n00) + (0, 3*\vsep) $)}
            \neuron[alt=<10>{fill=red!10!black}{fill=babagreen!95}]{n04}{($ (n00) + (0, 4*\vsep) $)}

            \neuron[alt=<10>{fill=red!55!black}{fill=babagreen!35!yellow}]{n10}{($ (n00) + (\hsep, 0.5*\vsep) $)}
            \neuron[alt=<10>{fill=yellow!20!red}{fill=babagreen!55}]{n11}{($ (n00) + (\hsep, 1.5*\vsep) $)}
            \neuron[alt=<10>{fill=yellow!90!red}{fill=babagreen!87!yellow}]{n12}{($ (n00) + (\hsep, 2.5*\vsep) $)}
            \neuron[alt=<10>{fill=red!7!black}{fill=babagreen!92}]{n13}{($ (n00) + (\hsep, 3.5*\vsep) $)}

            \neuron[alt=<10>{fill=red!90!black}{fill=babagreen!51}]{n20}{($ (n00) + (2*\hsep, \vsep) $)}
            \neuron[alt=<10>{fill=red!30!black}{fill=babagreen!52!yellow}]{n21}{($ (n00) + (2*\hsep, 2*\vsep) $)}
            \neuron[alt=<10>{fill=yellow!70!red}{fill=babagreen!81!yellow}]{n22}{($ (n00) + (2*\hsep, 3*\vsep) $)}

            \neuron[alt=<10>{fill=yellow!40!red}{fill=babagreen!90}]{n30}{($ (n00) + (3*\hsep, 1.5*\vsep) $)}
            \neuron[alt=<10>{fill=red!65!black}{fill=babagreen!41!yellow}]{n31}{($ (n00) + (3*\hsep, 2.5*\vsep) $)}

            \neuron[alt=<10>{fill=red}{fill=babagreen!62!yellow}]{n40}{($ (n00) + (4*\hsep, 2*\vsep) $)}

            \foreach \j in {0,...,4} {
                \draw[draw=black, opacity=\edgeopacity] ($ (model.west) - (0, 0.2175) $) -- (n0\j);
            }

            \foreach \j in {0,...,4} {
                \foreach \k in {0,...,3} {
                    \draw[draw=black, opacity=\edgeopacity] (n0\j) -- (n1\k);
                }
            }
            \foreach \j in {0,...,3} {
                \foreach \k in {0,...,2} {
                    \draw[draw=black, opacity=\edgeopacity] (n1\j) -- (n2\k);
                }
            }
            \foreach \j in {0,...,2} {
                \foreach \k in {0,...,1} {
                    \draw[draw=black, opacity=\edgeopacity] (n2\j) -- (n3\k);
                }
            }

            \draw[draw=black, opacity=\edgeopacity] (n30) -- (n40);
            \draw[draw=black, opacity=\edgeopacity] (n31) -- (n40);
            \draw[draw=black, opacity=\edgeopacity] (n40) -- ($ (model.east) - (0, 0.2175) $);

            \node[anchor=east, inner sep=0pt, draw=black] (input) at ($ (model.west) - (1.5, 0.2175) $) {
                \only<1-9>{%
                    \includegraphics[width=2cm]{data/ladybug.png}
                }%
                \only<10>{%
                    \includegraphics[width=2cm]{data/ladybug_explanation.png}
                }%
            };
            \node[font=\small, anchor=west] (output) at ($ (model.east) + (1.5, -0.2175) $) {
                Ladybug
            };
            \draw[alt=<10>{red, stealth-}{black, -stealth}] (input) -- ($ (model.west) - (0, 0.2175) $);
            \draw[alt=<10>{red, stealth-}{black, -stealth}] ($ (model.east) - (0, 0.2175) $) -- (output);
        }
        \only<2-3,8-9>{
            \node[circle, draw=black, alt=<9>{fill=babared}{fill=babagreen}, minimum size=0.5cm] (neuron) at (0, -1.9) {};

            \node[anchor=east, font=\scriptsize] (x1) at ($ (neuron) - (0.75, -0.5) $) {
                \only<2-8>{$\text{input}_1$}%
                \only<9->{$\text{importance}_1$}%
            };
            \node[anchor=east, font=\scriptsize] (x2) at ($ (neuron) - (0.75, 0) $) {
                \only<2-8>{$\text{input}_2$}%
                \only<9->{$\text{importance}_2$}%
            };
            \node[anchor=east, font=\scriptsize] (x3) at ($ (neuron) - (0.75, 0.5) $) {
                \only<2-8>{$\text{input}_3$}%
                \only<9->{$\text{importance}_3$}%
            };

            \node[anchor=west, font=\scriptsize] (y) at ($ (neuron) + (0.75, 0) $) {$\text{output}$};

            \draw[alt=<9>{red, stealth-}{black, -stealth}] (x1) -- (neuron);
            \draw[alt=<9>{red, stealth-}{black, -stealth}] (x2) -- (neuron);
            \draw[alt=<9>{red, stealth-}{black, -stealth}] (x3) -- (neuron);
            \draw[alt=<9>{red, stealth-}{black, -stealth}] (neuron) -- (y);

            \node[font=\small] at ($ (neuron) + (0, 1.1) $) {
                Artificial neuron
            };
        }
        \only<3,8-9>{
            \node[font=\footnotesize] at (0, -3) {
                \only<2-8>{%
                    $\text{output}=\text{max}(0, b+w_1*\text{input}_1+w_2*\text{input}_2+w_3*\text{input}_3)$
                }%
                \only<9->{%
                    $\text{importance}_i=\frac{\text{input}_i*w_i}{\sum\text{input}_j*w_j} * output$
                }%
            };
        }
        \only<4>{
            \node[inner sep=0pt, draw=black] at (0, 0) {
                \includegraphics[width=9cm]{data/Osten_und_Hans.jpg}
            };
        }
        \only<5-6>{
            \node[draw=black, inner sep=0pt] (husky) at (-3.75, 0) {
                \includegraphics[height=4cm]{data/HD-Siberian-Husky-Backgrounds.jpg}
            };

            \node[draw=black, inner sep=0pt] (wolf) at (3.75, 0) {
                \includegraphics[height=4cm]{data/Gray-wolf.png}
            };
        }
        \only<6>{
            \node[draw=red, thick, minimum width=1cm, minimum height=0.5cm] at ($ (wolf.south east) + (-0.8, 0.4) $) {};
        }
        \only<7>{
            \node[inner sep=0pt, draw=black] (xray) at (0, 0.4) {
                \includegraphics[width=4.5cm]{data/xray.png}
            };
            \node[draw=red, thick, minimum width=0.4cm, minimum height=0.4cm] at ($ (xray.north east) - (0.27, 0.27) $) {};
            \node[anchor=south, font=\tiny, text width=10.5cm, align=flush center] at (0, -3.5) {
                Banerjee, I., Bhattacharjee, K., Burns, J. L., Trivedi, H., Purkayastha, S., Seyyed-Kalantari, L., ... \& Gichoya, J. (2023). “Shortcuts” causing bias in radiology artificial intelligence: causes, evaluation, and mitigation. \textit{Journal of the American College of Radiology}, \textit{20}(9), 842-851.
            };
        }
    \end{tikzpicture}
\end{frame}

\begin{frame}{Explainable artificial intelligence and dementia}
\end{frame}