\section{Explainable artificial intelligence for dementia}

\newcommand{\scannersubplot}[3]{
    \nextgroupplot[
            axis lines=center,
            axis y line=none,
            xmin=46,
            xmax=99,
            ymin=-1.65,
            ymax=1.5,
            xmajorticks=false,
            axis line style={-}
        ]

            \addplot[name path=zero, draw=none] coordinates {(46, 0) (99, 0)};
            \addplot[
                name path=fcases,
                draw=cases-default,
                very thick
            ] table [
                col sep=comma,
                x=x,
                y=F-cases
            ]{#1};
            \addplot[fill=cases-default, opacity=0.2] fill between [of=zero and fcases];

            \addplot[
                name path=fcontrols,
                draw=controls-default,
                very thick
            ] table [
                col sep=comma,
                x=x,
                y=F-controls
            ]{#1};
            \addplot[fill=controls-default, opacity=0.2] fill between [of=zero and fcontrols];

            \addplot[
                name path=mcases,
                draw=cases-default,
                very thick
            ] table [
                col sep=comma,
                x=x,
                y expr=\thisrow{M-cases} * -1
            ]{#1};
            \addplot[fill=cases-default, opacity=0.2] fill between [of=zero and mcases];

            \addplot[
                name path=mcontrols,
                draw=controls-default,
                very thick
            ] table [
                col sep=comma,
                x=x,
                y expr=\thisrow{M-controls} * -1
            ]{#1};
            \addplot[fill=controls-default, opacity=0.2] fill between [of=zero and mcontrols];

            \node[anchor=south] at (axis cs: 72.5,1) {\tiny{#2}};
            \node[anchor=north] at (axis cs: 72.5,-1) {\tiny{\textbf{n=#3}}};
}

\newsavebox{\fulldementiadataset}
\sbox{\fulldementiadataset}{
    \begin{tikzpicture}
        \begin{axis}[
            width=\textwidth,
            height=0.4\textwidth,
            xmin=46,
            xmax=99,
            ymin=-1.6,
            ymax=1.2,
            xtick={55,60,65,70,75,80,85,90,95},
            axis lines=center,
            axis y line=none,
            clip=false
        ]
            \addplot[name path=zero, draw=none] coordinates {(47,0) (97,0)};

            \addplot[
                name path=fcases,
                draw=cases-default,
                very thick
            ] table [
                col sep=comma,
                x=x,
                y=F-cases
            ]{data/dementia_dataset/dementia_full.csv};\label{trace:cases}
            \addplot[fill=cases-default, opacity=0.2] fill between [of=zero and fcases];

            \addplot[
                name path=fcontrols,
                draw=controls-default,
                very thick
            ] table [
                col sep=comma,
                x=x,
                y=F-controls
            ]{data/dementia_dataset/dementia_full.csv};\label{trace:controls}
            \addplot[fill=controls-default, opacity=0.2] fill between [of=zero and fcontrols];

            \addplot[
                name path=mcases,
                draw=cases-default,
                very thick
            ] table [
                col sep=comma,
                x=x,y
                expr=\thisrow{M-cases} * -1
            ]{data/dementia_dataset/dementia_full.csv};
            \addplot[fill=cases-default, opacity=0.2] fill between [of=zero and mcases];

            \addplot[
                name path=mcontrols,
                draw=controls-default,
                very thick
            ] table [
                col sep=comma,
                x=x,
                y expr=\thisrow{M-controls} * -1
            ]{data/dementia_dataset/dementia_full.csv};
            \addplot[fill=controls-default, opacity=0.2] fill between [of=zero and mcontrols];

            \node[anchor=south west] at (axis cs: 46, 0.07) {\textbf{FEMALE}};
            \node[anchor=north west] at (axis cs: 46, -0.07) {\textbf{MALE}};
            \node[anchor=south, font=\footnotesize\selectfont, align=center] (n) at (axis cs: 72.5,-1.6) {n=1708};
            \node[anchor=south west,font=\footnotesize\selectfont, align=left] at ($(n.south east) + (110,0) $) {
                \ref{trace:controls} Controls\\[-0.1cm]
                \ref{trace:cases} Patients
            };
        \end{axis}
    \end{tikzpicture}
}

\newsavebox{\dementiasubsets}
\sbox{\dementiasubsets}{
    \begin{tikzpicture}
        \begin{groupplot}[
            group style={
                group size=5 by 2,
                horizontal sep=0.25cm,
                vertical sep=0.25cm
            },
            height=0.314\textwidth,
            width=0.314\textwidth
        ]
            \scannersubplot{data/dementia_dataset/dementia_ADNI_30T.csv}{ADNI 3.0T}{506}
            \scannersubplot{data/dementia_dataset/dementia_oasis3_30T.csv}{OASIS3 3.0T}{438}
            \scannersubplot{data/dementia_dataset/dementia_ADNI_15T.csv}{ADNI 1.5T}{290}
            \scannersubplot{data/dementia_dataset/dementia_Oslo_GE750.csv}{Oslo GE750}{226}
            \scannersubplot{data/dementia_dataset/dementia_AIBL_10.csv}{AIBL Site 1}{92}
            \scannersubplot{data/dementia_dataset/dementia_addneuromed_GE_MEDICAL_SYSTEMS.csv}{ANM GE}{74}
            \scannersubplot{data/dementia_dataset/dementia_miriad_15_T_Signa.csv}{MIRIAD}{38}
            \scannersubplot{data/dementia_dataset/dementia_AIBL_20.csv}{AIBL Site 2}{22}
            \scannersubplot{data/dementia_dataset/dementia_addneuromed_PICKER_International_Inc.csv}{ANM Picker}{12}
            \scannersubplot{data/dementia_dataset/dementia_oasis3_15T.csv}{OASIS3 1.5T}{10}
        \end{groupplot}
    \end{tikzpicture}
}

\begin{frame}[t]{Dementia: Dataset}
    \centering
    \vfill

    \begin{tikzpicture}
        \node[draw=black] at (-5.25, 3.25) {};
        \node[draw=black] at (5.25, -3.25) {};

        \visible<1-2>{
            \node[anchor=north] at (0, 3.5) {
                \usebox{\fulldementiadataset}
            };
        }
        \visible<2-3>{
            \node[] at (0, -1.5) {
                \usebox{\dementiasubsets}
            };
        }
    \end{tikzpicture}
\end{frame}

\newcommand{\mriside}[3]{
    \def\mridepth{0.75}

    \node[inner sep=0pt] (input) at (#1, #2) {
        \includegraphics[height=1.5cm, width=1.5cm]{#3}
    };

    \draw[fill=black] (input.north west) --
        ($ (input.north west) + (0.5 * \mridepth, 0.5 * \mridepth) $) --
        ($ (input.north east) + (0.5 * \mridepth, 0.5 * \mridepth) $) --
        (input.north east) -- cycle;
    \draw[fill=black] (input.north east) --
        ($ (input.north east) + (0.5 * \mridepth, 0.5 * \mridepth) $) --
        ($ (input.south east) + (0.5 * \mridepth, 0.5 * \mridepth) $) --
        (input.south east) -- cycle;
    \draw[] (input.north west) --
        ($ (input.north west) - (0.5 * \mridepth, 0.5 * \mridepth) $) --
        ($ (input.south west) - (0.5 * \mridepth, 0.5 * \mridepth) $) --
        (input.south west) -- cycle;
    \draw[] (input.north east) --
        ($ (input.north east) - (0.5 * \mridepth, 0.5 * \mridepth) $) --
        ($ (input.south east) - (0.5 * \mridepth, 0.5 * \mridepth) $) --
        (input.south east) -- cycle;
    \draw[] ($ (input.north west) - (0.5 * \mridepth, 0.5 * \mridepth) $) --
        ($ (input.north east) - (0.5 * \mridepth, 0.5 * \mridepth) $);
    \draw[] ($ (input.south west) - (0.5 * \mridepth, 0.5 * \mridepth) $) --
        ($ (input.south east) - (0.5 * \mridepth, 0.5 * \mridepth) $);
}


\newcommand{\inputside}[2]{
    \mriside{#1}{#2}{data/mri_sagittal.png}
}

\newcommand{\segmentationside}[2]{
    \mriside{#1}{#2}{data/segmentation.png}
}

\newcommand{\heatmapside}[2]{
    \mriside{#1}{#2}{data/combined_sagittal.png}
}

\newcommand{\convside}[6]{
    \def\sidex{#1}
    \def\sidey{#2}
    \def\sidewidth{#3}
    \def\sideheight{#4}
    \def\sidefillcolour{#5}
    \def\sidename{#6}

    \node[
        fill=\sidefillcolour,
        inner sep=0pt,
        outer sep=0pt,
        minimum width=\sidewidth,
        minimum height=\sideheight,
        draw=black
    ] (\sidename) at (\sidex, \sidey) {};
}

\newcommand{\convtop}[4]{
    \def\topbase{#1}
    \def\topwidth{#2}
    \def\topheight{#3}
    \def\topfillcolour{#4}

    \draw[fill=\topfillcolour,draw=black] #1 --
        ($ #1 + (#3, #3) $) --
        ($ #1 + (#3+#2, #3) $) --
        ($ #1 + (#2, 0) $);
}

\newcommand{\convfront}[3]{
    \def\frontbase{#1}
    \def\frontsize{#2}
    \def\frontfillcolour{#3}

    \draw[black, fill=\frontfillcolour] #1 --
        ($ #1 + (1*#2, 1*#2) $) --
        ($ #1 + (1*#2, 1*#2 - 2*#2) $) --
        ($ #1 + (0, -2*#2) $);
}

\newcommand{\convchannel}[7]{
    \def\channelx{#1}
    \def\channely{#2}
    \def\channelnodedepth{#3}
    \def\channelnodesize{#4}
    \def\channelnodecount{#5}
    \def\channelcolour{#6}
    \def\includefront{#7}

    \def\huemin{20}
    \def\huemax{80}

    \pgfmathsetmacro{\iterations}{#5-1}
    \foreach \i in {0,...,\iterations} {
        \pgfmathsetmacro{\hue}{int(random(\huemin, \huemax))}
        \convside{#1}{#2+\i*-#4}{#3 cm}{#4 cm}{#6!\hue}{n\i0}

        \foreach \j in {0,...,\iterations} {
            \pgfmathsetmacro{\innerhue}{int(random(\huemin, \huemax))}
            \ifnum\j=0
                \pgfmathsetmacro{\innerhue}{\hue}
            \fi

            \ifnum\includefront=1
                \convfront{($ (n00.north east) + (0.5*\j*#4, 0.5*\j*#4 - \i*#4) $)}{0.5*#4}{#6!\innerhue}
            \fi

            \ifnum\i=0
                \convtop{($ (n\i0.north west) + (0.5*\j*#4, 0.5*\j*#4) $)}{#3}{0.5*#4}{#6!\innerhue}
            \fi
        }
    }
}

\newcommand{\lrpchannel}[6]{
    \def\channelx{#1}
    \def\channely{#2}
    \def\channelnodedepth{#3}
    \def\channelnodesize{#4}
    \def\channelnodecount{#5}
    \def\includefront{#6}

    \colorlet{bgcolour}{black!85}

    \pgfmathsetmacro{\iterations}{#5-1}
    \foreach \i in {0,...,\iterations} {
        \pgfmathsetmacro{\hue}{int(random(-150, 100))}
        \colorlet{fillcolour}{bgcolour}

        \colorlet{lrpcolour}{red}
        \pgfmathsetmacro{\coinflip}{int(random(0, 1))}

        \ifnum\coinflip=1
            \colorlet{lrpcolour}{blue}
        \fi

        \ifnum\hue>0
            \colorlet{fillcolour}{lrpcolour!\hue!bgcolour}
        \fi

        \convside{#1}{#2+\i*-#4}{#3 cm}{#4 cm}{fillcolour}{n\i0}

        \foreach \j in {0,...,\iterations} {
            \pgfmathsetmacro{\innerhue}{int(random(-150, 100))}
            \colorlet{innerfillcolour}{bgcolour}

            \ifnum\innerhue>0
                \colorlet{innerfillcolour}{lrpcolour!\innerhue!bgcolour}
            \fi

            \ifnum\j=0
                \colorlet{innerfillcolour}{fillcolour}
            \fi

            \ifnum\includefront=1
                \convfront{($ (n00.north east) + (0.5*\j*#4, 0.5*\j*#4 - \i*#4) $)}{0.5*#4}{innerfillcolour}
            \fi

            \ifnum\i=0
                \convtop{($ (n\i0.north west) + (0.5*\j*#4, 0.5*\j*#4) $)}{#3}{0.5*#4}{innerfillcolour}
            \fi
        }
    }
}

\newcommand{\convlayer}[7]{
    \def\layerx{#1}
    \def\layery{#2}
    \def\layernodedepth{#3}
    \def\layernodesize{#4}
    \def\layernodecount{#5}
    \def\layerdepth{#6}
    \def\layercolour{#7}

    \pgfmathsetmacro{\layeriterations}{\layerdepth-1}
    \foreach \i in {0,...,\layeriterations}{
        \pgfmathsetmacro{\x}{\layerx + \i * \layernodedepth}
        \pgfmathsetmacro{\islast}{\i == \layeriterations ? 1 : 0}
        \convchannel{\x}{\layery}{\layernodedepth}{\layernodesize}{\layernodecount}{\layercolour}{\islast}
    }
}

\newcommand{\lrplayer}[6]{
    \def\layerx{#1}
    \def\layery{#2}
    \def\layernodedepth{#3}
    \def\layernodesize{#4}
    \def\layernodecount{#5}
    \def\layerdepth{#6}

    \pgfmathsetmacro{\layeriterations}{\layerdepth-1}
    \foreach \i in {0,...,\layeriterations}{
        \pgfmathsetmacro{\x}{\layerx + \i * \layernodedepth}
        \pgfmathsetmacro{\islast}{\i == \layeriterations ? 1 : 0}
        \lrpchannel{\x}{\layery}{\layernodedepth}{\layernodesize}{\layernodecount}{\islast}
    }
}

\newcommand{\modelarrow}[5]{
    \begin{scope}[transparency group, opacity=0.5]
        \draw[-stealth, line width=2pt, #3] #1 to [in=#4, out=#5] #2;
    \end{scope}
}

\newcommand{\cnnarrow}[3]{
    \modelarrow{#1}{#2}{#3}{180}{0}
}

\newcommand{\lrparrow}[3]{
    \modelarrow{#1}{#2}{#3}{0}{180}
}

\newcommand{\cnn}[6]{
    \def\xmin{#1}
    \def\ymin{#2}
    \def\nodedepth{#3}
    \def\nodesize{#4}
    \def\modelcolour{#5}
    \def\annotate{#6}

    \convlayer{#1 - 0.06 + 0.4}{#2 + 2.5 * #4}{#3}{#4}{12}{3}{\modelcolour}
    \cnnarrow{(#1 + 0.95, #2)}{(#1+2.2, #2)}{#5}

    \convlayer{#1 + 1.44 + 0.4}{#2 + 1.5 * #4}{#3}{#4}{8}{5}{\modelcolour}
    \cnnarrow{(#1 + 2.43, #2)}{(#1+3.5, #2)}{#5}

    \convlayer{#1 + 2.77 + 0.4}{#2 + 0.5 * #4}{#3}{#4}{4}{7}{\modelcolour}
    \cnnarrow{(#1 + 3.75, #2)}{(#1+5, #2)}{#5}

    \convlayer{#1 + 3.93 + 0.4}{#2 + 0}{#3}{#4}{2}{9}{\modelcolour}

    \ifdim #6 pt = 1 pt
        \draw[thick, dashed] (#1 + 0.22, #2 + 1.43) --
                            (#1 + 5.13, #2 + 1.43) --
                            (#1 + 5.13, #2 - 1.42) --
                            (#1 + 0.22, #2 - 1.42) -- cycle;
        \node[anchor=south, text depth=0, font=\scriptsize\selectfont] at (#1 + 2.675, #2 + 1.43) {
            \textbf{3D Simple Fully Convolutional Network}
        };
    \fi
}

\newcommand{\lrp}[4]{
    \def\xmin{#1}
    \def\ymin{#2}
    \def\nodedepth{#3}
    \def\nodesize{#4}

    \lrplayer{#1 - 0.06 + 0.4}{#2 + 2.5 * #4}{#3}{#4}{12}{3}{black}
    \lrparrow{(#1+2.2, #2)}{(#1 + 0.95, #2)}{black}

    \lrplayer{#1 + 1.44 + 0.4}{#2 + 1.5 * #4}{#3}{#4}{8}{5}{black}
    \lrparrow{(#1+3.5, #2)}{(#1 + 2.43, #2)}{black}

    \lrplayer{#1 + 2.77 + 0.4}{#2 + 0.5 * #4}{#3}{#4}{4}{7}{black}
    \lrparrow{(#1+5, #2)}{(#1 + 3.75, #2)}{black}

    \lrplayer{#1 + 3.93 + 0.4}{#2 + 0}{#3}{#4}{2}{9}{black}
}

\newcommand{\cnnbox}[1]{
    \definecolor{hippocampus}{HTML}{74c476}
    \definecolor{thalamus}{HTML}{e6550d}
    \definecolor{cortex}{HTML}{7eaaf1}

    \begin{tikzpicture}
        \node[] at (-2.5, 0) {};
        \node[] at (7.6, 0) {};

        \ifnum#1=0
            \node[
                font=\scriptsize\linespread{0.9}\selectfont,
                align=center,
                anchor=west
            ] (output) at (5.5, 0) {
                Diagnostic\\status
            };
        \fi
        \ifnum#1=1
            \node[
                font=\small\linespread{0.9}\selectfont,
                align=center,
                anchor=west
            ] (output) at (5.35, 0) {
                Apparent\\brain age
            };
        \fi
        \ifnum#1=3
            \node[
                font=\small\linespread{0.9}\selectfont,
                align=center,
                anchor=west
            ] (output) at (5.35, 0) {
                Apparent\\brain age
            };
        \fi

        \ifnum#1<2
            \inputside{-1.4}{0}
            \cnnarrow{(input.east)}{($ (input.center) + (2, 0) $)}{black}
        \fi
        \ifnum#1=0
            \cnn{0}{0}{0.066}{0.15}{black}{1}
        \fi
        \ifnum#1=1
            \cnn{0}{0}{0.066}{0.15}{black}{0}
        \fi
        \ifnum#1<2
            \cnnarrow{($ (output.west) - (0.54, 0) $)}{($ (output.west) + (0.1, 0) $)}{black}
        \fi


        \ifnum#1=3
            \heatmapside{-1.4}{0}

            \lrp{0}{0}{0.066}{0.15}

            \lrparrow{($ (input.center) + (2, 0) $)}{(input.east)}{black}
            \lrparrow{($ (output.west) + (0.1, 0) $)}{($ (output.west) - (0.39, 0) $)}{black}
        \fi
    \end{tikzpicture}
}

\newsavebox{\cnntraining}
\sbox{\cnntraining}{
    \cnnbox{0}
}

\newsavebox{\dementiapredictions}
\sbox{\dementiapredictions}{
    \pgfplotstableread[col sep=comma]{data/test_distributions.csv}\testdistributions
    \pgfplotstableread[col sep=comma]{data/test_predictions.csv}\testpredictions

    \newcommand{\ymin}{-0.35}
    \newcommand{\ymax}{1.05}

    \begin{tikzpicture}
        \begin{axis}[
            name=distributions,
            height=0.5\textwidth,
            width=0.94\textwidth,
            xtick pos=bottom,
            ymajorticks=false,
            xmin=0,
            xmax=1,
            ymin=\ymin,
            ymax=\ymax,
            xlabel=\small{Prediction},
            every tick label/.append style={font=\footnotesize}
        ]
            \addplot[name path=controls, draw=controls-default, very thick] table [x=prediction,y=controls]{\testdistributions};
            \addplot[name path=cases, draw=cases-default, very thick] table [x=prediction,y=cases]{\testdistributions};
            \addplot[name path=zero, draw=black] coordinates {(0,0) (1,0)};
            \addplot[fill=controls-default, opacity=0.2] fill between [of=zero and controls];
            \addplot[fill=cases-default, opacity=0.2] fill between [of=zero and cases];
            \addplot[
                scatter/classes={
                    control={controls-default, draw=black, opacity=0.5},
                    case={cases-default, draw=black, opacity=0.5}
                },
                scatter,
                mark=*,
                only marks,
                point meta=explicit symbolic
            ] table [
                y expr=\thisrow{y} * -0.15 - 0.1,
                meta=class,
            ] {\testpredictions};
            \addplot[dashed] coordinates {(0.5, \ymin) (0.5, \ymax)};
        \end{axis}

        \node[anchor=south west] at ($ (distributions.south east) + (0,0.28) $) {\tiny{Controls}};
        \node[anchor=south west] at ($ (distributions.south east) + (0,0.0) $) {\tiny{Cases}};
        \node[anchor=south,align=center] at (distributions.north) {\tiny{$t=0.5$}};
    \end{tikzpicture}
}

\begin{frame}[t]{Dementia: Modelling}
    \colorlet{train}{green}
    \colorlet{val}{blue}
    \colorlet{test}{red}

    \def\datasetheight{0.4cm}
    \def\datasetwidth{1.9cm}

    \begin{tikzpicture}
        \node[draw=black] at (-5.25, 3.5) {};
        \node[draw=black] at (5.25, -3.5) {};

        \visible<1-6>{
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d00) at (-5, 2.5) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d01) at (d00.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d02) at (d01.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=val, draw=black, anchor=west] (d03) at (d02.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=test, draw=black, anchor=west] (d04) at (d03.east) {};

            \node[anchor=south, font=\scriptsize\selectfont, text depth=0] at (d01.north) {Training};
            \node[anchor=south, font=\scriptsize\selectfont, text depth=0] at (d03.north) {Validation};
            \node[anchor=south, font=\scriptsize\selectfont, text depth=0] at (d04.north) {Test};
        }

        \visible<2-3>{
            \node[draw=black, dashed, align=center, font=\scriptsize] (fit) at ($ (d01.south) - (0, 1) $) {
                Model\\fitting
            };
            \draw[-stealth] (d01) -- (fit);
        }
        \visible<3>{
            \node[] at (0, -1.5) {
                \usebox{\cnntraining}
            };
        }
        \visible<4-5>{
            \node[draw=gray!50, dashed, align=center, font=\scriptsize, text=gray!50] (fit) at ($ (d01.south) - (0, 1) $) {
                Model\\fitting
            };
            \draw[-stealth, gray!50] (d01) -- (fit);
        }
        \visible<4>{
            \node[draw=black, dashed, align=center, font=\scriptsize] (search) at ($ (d03.south) - (0, 1) $) {
                Model\\selection
            };
            \draw[-stealth] (d03) -- (search);
            \draw[-stealth] (fit) -- (search);

            \node[font=\scriptsize\selectfont] at (0, -1.5) {
                \begin{tabular}{|c|c|}
                    \hline
                    \textbf{Hyperparameter}&\textbf{Values}\\
                    \hline
                    Weight decay&$\{10^{-2}, 10^{-3}\}$\\
                    \hline
                    Dropout&$\{0.25, 0.5\}$\\
                    \hline
                    Learning rate schedule&\{stepwise, cyclic, one-cycle\}\\
                    \hline
                    Augmentations&\{light, heavy\}\\
                    \hline
                \end{tabular}
            };
        }
        \visible<5>{
            \node[draw=black, dashed, align=center, font=\scriptsize, draw=gray!50, text=gray!50] (search) at ($ (d03.south) - (0, 1) $) {
                Model\\selection
            };
            \draw[-stealth, draw=gray!50] (d03) -- (search);
            \draw[-stealth, draw=gray!50] (fit) -- (search);
        }
        \visible<5>{
            \node[draw=black, dashed, align=center, font=\scriptsize] (eval) at ($ (d04.south) - (0, 1) $) {
                Model\\evaluation
            };
            \draw[-stealth] (d04) -- (eval);
            \draw[-stealth] (search) -- (eval);
        }

        \visible<6>{
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d00) at (-5, 1.25) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d01) at (d00.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=val, draw=black, anchor=west] (d02) at (d01.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=test, draw=black, anchor=west] (d03) at (d02.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d04) at (d03.east) {};

            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d00) at (-5, 0) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=val, draw=black, anchor=west] (d01) at (d00.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=test, draw=black, anchor=west] (d02) at (d01.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d03) at (d02.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d04) at (d03.east) {};

            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=val, draw=black, anchor=west] (d00) at (-5, -1.25) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=test, draw=black, anchor=west] (d01) at (d00.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d02) at (d01.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d03) at (d02.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d04) at (d03.east) {};

            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=test, draw=black, anchor=west] (d00) at (-5, -2.5) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d01) at (d00.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d02) at (d01.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=train, draw=black, anchor=west] (d03) at (d02.east) {};
            \node[minimum height=\datasetheight, minimum width=\datasetwidth, fill=val, draw=black, anchor=west] (d04) at (d03.east) {};
        }
        \visible<7>{
            \node[anchor=north] at (0, 3.25) {
                \usebox{\dementiapredictions}
            };
        }
    \end{tikzpicture}
\end{frame}
