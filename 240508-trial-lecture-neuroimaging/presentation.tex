\documentclass[10pt]{beamer}

\usetheme{metropolis}

\usepackage[export]{adjustbox}
\usepackage{array}
\usepackage{enumitem}
\usepackage{etoolbox}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{tikz}
\usepackage{transparent}
\usepackage{xcolor}

\usepgfplotslibrary{fillbetween}
\usepgfplotslibrary{groupplots}
\usepgfplotslibrary{statistics}

\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{calc}
\usetikzlibrary{fadings}
\usetikzlibrary{fillbetween}
\usetikzlibrary{patterns}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.arrows}

\hypersetup{
    colorlinks=true,
    linkcolor=white,
    urlcolor=blue!80
}

\definecolor{uiored}{HTML}{DD0000}
\definecolor{uiolightred}{HTML}{FB6666}
\definecolor{uioredtone}{HTML}{FEE0E0}
\definecolor{uioblue}{HTML}{3E31D6}
\definecolor{uiolightblue}{HTML}{86A4F7}
\definecolor{uioblueone}{HTML}{E6ECFF}
\definecolor{uiogreen}{HTML}{2EC483}
\definecolor{uiolightgreen}{HTML}{6CE1AB}
\definecolor{uiogreentone}{HTML}{CEFFDF}
\definecolor{uioorange}{HTML}{FEA11B}
\definecolor{uiolightorange}{HTML}{FDCB87}
\definecolor{uioorangetone}{HTML}{FFE8D4}
\definecolor{uioyellow}{HTML}{FFFEA7}
\definecolor{uiogray}{HTML}{B2B3B7}

\colorlet{mainbackground}{uiored}

\setbeamercolor{frametitle}{bg=mainbackground, fg=white}
\setbeamercolor{title separator}{fg=mainbackground}
\setbeamercolor{progress bar in section page}{fg=white, bg=uiogray}

\def\logowidth{4cm}

\makeatletter
\setbeamertemplate{section page}
{
  \begingroup

    \vspace{4.3cm}
    {\usebeamercolor[fg]{section title}\usebeamerfont{section title}\insertsectionhead}\\[-1ex]
    {\centering\color{white}\rule{\linewidth}{1pt}\par} % the horizontal line

    \vspace*{3.1cm}
    \begin{center}
        \includegraphics[width=\logowidth,valign=c]{data/uio_logo_full_white.png} % Adjust width and path to your logo as needed
    \end{center}

  \endgroup
}
\makeatother

\AtBeginSection{
  {
    \setbeamercolor{background canvas}{bg=uiored}
    \setbeamercolor{section title}{fg=white}
    \frame[plain,c,noframenumbering]{\sectionpage}
    \setbeamercolor{background canvas}{bg=black!2}
  }
}



\setbeamertemplate{footline}{
    \ifnum\insertframenumber=1
        % Title page, no footer
    \else
        \begin{tikzpicture}[remember picture,overlay]
            \fill[mainbackground] (current page.south west) rectangle ([yshift=0.45cm]current page.south east); % Draw filled rectangle

            % Logo
            \node[anchor=west, yshift=0.225cm] at (current page.south west) {\includegraphics[height=1.2cm]{data/uio_logo_white.png}};

            % Title and subtitle
            \node[align=center, yshift=0.225cm] at (current page.south) {\textcolor{white}{\textbf{\inserttitle}}\\[0.05cm]\textcolor{white}{\insertsubtitle}};

            % Page number
            \node[anchor=east, yshift=0.225cm, xshift=-0.2cm, align=right] at (current page.south east) {\textcolor{white}{\insertframenumber/\inserttotalframenumber}};
        \end{tikzpicture}
    \fi
}

\subtitle{The role of neuroimaging beyond T1-weighted MRI in the diagnosis and prediction of neuropsychiatric disorders}
\author{Esten H. Leonardsen}
\date{26.10.23}

\definecolor{color1}{HTML}{f94144}
\definecolor{color2}{HTML}{f3722c}
\definecolor{color3}{HTML}{f8961e}
\definecolor{color4}{HTML}{f9c74f}
\definecolor{color5}{HTML}{90be6d}
\definecolor{color6}{HTML}{43aa8b}
\definecolor{color7}{HTML}{577590}

\colorlet{dem}{color1}
\colorlet{ms}{color2}
\colorlet{pd}{color3}
\colorlet{scz}{color4}
\colorlet{mdd}{color5}
\colorlet{bp}{color6}


\definecolor{studycolor1}{HTML}{f94144}
\definecolor{studycolor2}{HTML}{f3722c}
\definecolor{studycolor3}{HTML}{f9844a}
\definecolor{studycolor4}{HTML}{f8961e}
\definecolor{studycolor5}{HTML}{f9c74f}
\definecolor{studycolor6}{HTML}{90be6d}
\definecolor{studycolor7}{HTML}{43aa8b}
\definecolor{studycolor8}{HTML}{4d908e}
\definecolor{studycolor9}{HTML}{577590}
\definecolor{studycolor10}{HTML}{277da1}
\definecolor{studycolor11}{HTML}{4d908e}
\definecolor{studycolor12}{HTML}{577590}
\definecolor{studycolor13}{HTML}{277da1}

\def\summarytop{-0.2cm}
\def\summaryouteritems{-0.4em}
\def\summaryinneritems{-0.3em}
\def\summaryinnertop{-0.5em}

\titlegraphic{
	\centering
	\vspace{7.7cm}
	\includegraphics[width=\logowidth]{data/uio_logo_full.png}
}

\pgfplotsset{
    discard if not/.style 2 args={
        x filter/.code={
            \edef\tempa{\thisrow{#1}}
            \edef\tempb{#2}
            \ifx\tempa\tempb
            \else
                \def\pgfmathresult{inf}
            \fi
        }
    }
}

\begin{document}
	\begin{frame}
	 	\titlepage
	\end{frame}

    \begin{frame}{Overview}
        \begin{enumerate}[label=\theenumi.]
            \item Background: Defining the scope of the lecture.
            \item State-of-the-art: How is neuroimaging beyond T1-weighted MRI currently being used to predict neuropsychiatric disorders.
            \item The future: Challenges and opportunities in using neuroimaging for predicting neuropsychiatric disorders moving forward.
        \end{enumerate}
    \end{frame}

    \newsavebox{\modalities}
    \sbox{\modalities}{%
        \begin{tikzpicture}
            \begin{axis}[
                ybar,
                height=5cm,
                width=6cm,
                bar width=0.8,
                xmin=0.35,
                xmax=4.65,
                ymin=0,
                xtick={1, 2, 3, 4},
                xticklabels={Structural MRI, Functional MRI, Diffusion MRI, Molecular imaging},
                x tick label style={
                    rotate=45,anchor=east,
                    font=\footnotesize
                },
                tick label style={
                    font=\footnotesize
                },
                ylabel={\footnotesize{Publications}},
                ymax=399,
                axis y line*=left,
                axis x line*=bottom,
                xtick align=outside
            ]
                \addplot[fill=gray!80] coordinates {
                    (1, 367)
                    (2, 186)
                    (3, 39)
                    (4, 43)
                };
            \end{axis}
        \end{tikzpicture}
    }

    \newcommand{\stickman}[2]{
        \node[circle,fill,minimum size=2.5mm,#2] (head) at #1 {};
        \node[rounded corners=1pt,minimum height=0.65cm,minimum width=0.2cm,fill,below = 0.5pt of head,#2] (body) {};
        \draw[line width=0.5mm,round cap-round cap,#2] ([shift={(1pt,-0.5pt)}]body.north east) --++(-90:3mm);
        \draw[line width=0.5mm,round cap-round cap,#2] ([shift={(-1pt,-0.5pt)}]body.north west)--++(-90:3mm);
        \draw[thick,white,-round cap] (body.south) --++(90:2.75mm);
    }

    \newcommand{\casecontrol}[1]{
        \begin{tikzpicture}
            \node[] at (-0.5, 0.2) {};
            \node[] at (7.8, -6.4) {};

            \ifnum#1<4
                \stickman{(2.1, -0.8)}{red}
                \stickman{(3.4, -1.7)}{red}
                \stickman{(2.2, -2.3)}{red}
                \stickman{(3.8, -1.2)}{red}
                \stickman{(4.7, -2.1)}{red}
                \stickman{(5.2, -1.1)}{red}
                \stickman{(4.2, -0.5)}{red}

                \stickman{(2.6, -2)}{blue}
                \stickman{(4.0, -2.4)}{blue}
                \stickman{(2.8, -0.9)}{blue}
                \stickman{(4.6, -1)}{blue}
                \stickman{(5.1, -2.0)}{blue}
                \stickman{(3.3, -2.3)}{blue}
                \stickman{(3.3, -0.5)}{blue}
            \fi

            \ifnum#1>1
                \ifnum#1<4
                    \stickman{(7, -3.2)}{red}
                    \stickman{(7, -4.4)}{red}
                    \stickman{(7, -5.6)}{red}
                    \stickman{(6.5, -3.8)}{red}
                    \stickman{(6.5, -5)}{red}
                    \stickman{(7.5, -3.8)}{red}
                    \stickman{(7.5, -5)}{red}
                    \node[] at (7, -2.7) {\footnotesize{Cases}};

                    \stickman{(0.2, -3.2)}{blue}
                    \stickman{(0.2, -4.4)}{blue}
                    \stickman{(0.2, -5.6)}{blue}
                    \stickman{(-0.3, -3.8)}{blue}
                    \stickman{(-0.3, -5)}{blue}
                    \stickman{(0.7, -3.8)}{blue}
                    \stickman{(0.7, -5)}{blue}
                    \node[] at (0.2, -2.7) {\footnotesize{Controls}};

                    \draw[-, line width=3pt, gray] (3.6, -3.4) -- (3.6, -4.8);
                    \draw[stealth-stealth, line width=3pt, gray] (1.25, -4.75) -- (5.95, -4.75);
                \fi
            \fi

            \ifnum#1=3
                \node[align=center,font=\scriptsize\linespread{0.8}\selectfont,
                draw=black, fill=white, inner sep=4pt] at (3.6, -4.8){
                    Predictive\\model
                };
            \fi
            \ifnum#1=4
                \node[align=center,font=\small\linespread{0.9}\selectfont] at (3.6, -4.2){
                        \underline{Accuracy}\\
                        50\%
                };
                    \stickman{(7, -3.2)}{red}
                    \stickman{(7, -4.4)}{blue}
                    \stickman{(7, -5.6)}{red}
                    \stickman{(6.5, -3.8)}{red}
                    \stickman{(6.5, -5)}{blue}
                    \stickman{(7.5, -3.8)}{red}
                    \stickman{(7.5, -5)}{blue}
                    \node[] at (7, -2.7) {\footnotesize{Cases}};

                    \stickman{(0.2, -3.2)}{red}
                    \stickman{(0.2, -4.4)}{red}
                    \stickman{(0.2, -5.6)}{blue}
                    \stickman{(-0.3, -3.8)}{blue}
                    \stickman{(-0.3, -5)}{red}
                    \stickman{(0.7, -3.8)}{blue}
                    \stickman{(0.7, -5)}{red}
                    \node[] at (0.2, -2.7) {\footnotesize{Controls}};
            \fi
            \ifnum#1>4
                \ifnum#1<6
                    \node[align=center,font=\small\linespread{0.9}\selectfont] at (3.6, -4.2){
                            \underline{Accuracy}\\
                            100\%
                    };

                    \stickman{(7, -3.2)}{red}
                    \stickman{(7, -4.4)}{red}
                    \stickman{(7, -5.6)}{red}
                    \stickman{(6.5, -3.8)}{red}
                    \stickman{(6.5, -5)}{red}
                    \stickman{(7.5, -3.8)}{red}
                    \stickman{(7.5, -5)}{red}
                \fi
                \ifnum#1>5
                    \stickman{(7, -3.2)}{red!75!blue}
                    \stickman{(7, -4.4)}{red!50!blue}
                    \stickman{(7, -5.6)}{red}
                    \stickman{(6.5, -3.8)}{red!60!blue}
                    \stickman{(6.5, -5)}{red!85!blue}
                    \stickman{(7.5, -3.8)}{red!95!blue}
                    \stickman{(7.5, -5)}{red!80!blue}
                \fi
                \node[] at (7, -2.7) {\footnotesize{Cases}};

                \stickman{(0.2, -3.2)}{blue}
                \stickman{(0.2, -4.4)}{blue}
                \stickman{(0.2, -5.6)}{blue}
                \stickman{(-0.3, -3.8)}{blue}
                \stickman{(-0.3, -5)}{blue}
                \stickman{(0.7, -3.8)}{blue}
                \stickman{(0.7, -5)}{blue}
                \node[] at (0.2, -2.7) {\footnotesize{Controls}};
            \fi
        \end{tikzpicture}
    }

    \newsavebox{\casecontrolgroup}
    \sbox{\casecontrolgroup}{%
        \casecontrol{1}
    }
    \newsavebox{\casecontrolgroups}
    \sbox{\casecontrolgroups}{%
        \casecontrol{2}
    }
    \newsavebox{\casecontrolmodel}
    \sbox{\casecontrolmodel}{%
        \casecontrol{3}
    }
    \newsavebox{\casecontrolbadacc}
    \sbox{\casecontrolbadacc}{%
        \casecontrol{4}
    }
    \newsavebox{\casecontrolgoodacc}
    \sbox{\casecontrolgoodacc}{%
        \casecontrol{5}
    }
    \newsavebox{\casecontrolpersonal}
    \sbox{\casecontrolpersonal}{%
        \casecontrol{6}
    }

    \begin{frame}[t]{Background}
        \centering
        \begin{tikzpicture}
            \colorlet{hiddencolour}{black!20}

            \def\labelsize{\scriptsize}

            \node[] at (0, 0) {};
            \node[] at (-5, 0) {};
            \node[] at (5, -7) {};
            \onslide<1>{
                \node[align=center] at (0, -0.5) {
                    The role of neuroimaging beyond T1-weighted MRI in the\\diagnosis and prediction of neuropsychiatric disorders
                };
            }
            \only<2-4>{
                \node[align=center] at (0, -0.5) {
                    \textcolor{hiddencolour}{The role of }neuroimaging \textcolor{hiddencolour}{beyond T1-weighted MRI in the}\\\textcolor{hiddencolour}{diagnosis and prediction of neuropsychiatric disorders}
                };
                \onslide<4->{
                    \node[label=below:{\labelsize{Sample from the MNE library}}] at (2, -4) {
                        \includegraphics[width=4cm]{data/eeg.png}
                    };
                }
            }
            \onslide<3-4,6-9>{
                \node[inner sep=0pt, label=below:{\labelsize{Bert from FreeSurfer 7.3}}] at (-3, -4) {
                    \includegraphics[width=2.5cm]{data/bert_sagittal.png}
                };
            }
            \only<5-9>{
                \node[align=center] at (0, -0.5) {
                    \textcolor{hiddencolour}{The role of neuroimaging beyond }T1-weighted MRI \textcolor{hiddencolour}{in the}\\\textcolor{hiddencolour}{diagnosis and prediction of neuropsychiatric disorders}
                };
                \only<7>{
                    \node[] at (2, -4.2) {
                        \includegraphics[width=4cm]{data/3d_bert.png}
                    };
                }
                \only<8>{
                    \node[inner sep=0pt, label=above:{\labelsize{Front}}] at (0, -4) {
                        \includegraphics[width=2.5cm]{data/bert_z.png}
                    };
                    \node[inner sep=0pt, label=above:{\labelsize{Above}}] at (3, -4) {
                        \includegraphics[width=2.5cm]{data/bert_y.png}
                    };
                }
                \only<9>{
                    \node[] at (2, -4.2) {
                        \usebox{\modalities}
                    };
                }
            }
            \only<10-12>{
                \def\nodefont{\footnotesize}
                \node[align=center] at (0, -0.5) {
                    \textcolor{hiddencolour}{The role of neuroimaging beyond T1-weighted MRI in the}\\\textcolor{hiddencolour}{diagnosis and prediction of }neuropsychiatric disorders
                };
                \onslide<11->{
                    \node[align=center, font=\nodefont] at (-2, -2) {
                        Alzheimer's disease (AD) and other\\causes of dementia (DEM)
                    };
                    \node[align=center, font=\nodefont] at (-2.8, -2.8) {
                        Multiple Sclerosis (MS)
                    };
                    \node[align=center, font=\nodefont] at (-1.3, -3.2) {
                        Parkinson's Disease (PD)
                    };
                }

                \onslide<12->{
                    \node[align=center, font=\nodefont] at (1.9, -2.2) {
                        Bipolar Disorder (BP)
                    };
                    \node[align=center, font=\nodefont] at (1.6, -2.6) {
                        Schizophrenia (SCZ)
                    };
                    \node[align=center, font=\nodefont] at (2.8, -3.3) {
                        Depressive disorders, including\\major depressive disorder (MDD)
                    };
                }
            }
            \onslide<13->{
                \node[align=center] at (0, -0.5) {
                    \textcolor{hiddencolour}{The role of neuroimaging beyond T1-weighted MRI in the}\\diagnosis and prediction \textcolor{hiddencolour}{of neuropsychiatric disorders}
                };
                \only<14>{
                    \node[label=below:{\scriptsize{Generated by DALL-E 3}}] at (0, -4.2) {
                        \includegraphics[width=5cm]{data/medical_consultancy.png}
                    };
                };
                \only<15>{
                    \node[] at (0, -4.2) {
                        \usebox{\casecontrolgroup}
                    };
                }
                \only<16>{
                    \node[] at (0, -4.2) {
                        \usebox{\casecontrolgroups}
                    };
                }
                \only<17>{
                    \node[] at (0, -4.2) {
                        \usebox{\casecontrolmodel}
                    };
                }
                \only<18>{
                    \node[] at (0, -4.2) {
                        \usebox{\casecontrolbadacc}
                    };
                }
                \only<19>{
                    \node[] at (0, -4.2) {
                        \usebox{\casecontrolgoodacc}
                    };
                }
                \only<20>{
                    \node[] at (0, -4.2) {
                        \usebox{\casecontrolpersonal}
                    };
                }
            }
        \end{tikzpicture}
    \end{frame}

    \section{\large{Neuroimaging modalities for diagnostic predictions}}

    \newcommand{\diagnosisplot}[1]{
        \begin{tikzpicture}
            \begin{axis}[
                ybar stacked,
                xmin=-0.5,
                xmax=5.5,
                height=4cm,
                width=5.7cm,
                xlabel=\footnotesize{Diagnosis},
                ylabel=\footnotesize{Studies},
                xtick={0, 1, 2, 3, 4, 5},
                xticklabels={DEM, MS, PD, SCZ, MDD, BP},
                ticklabel style = {font=\scriptsize, text depth=0},
                xtick pos=bottom,
                axis y line*=left,
                axis x line*=bottom,
                ymin=0,
                ymax=280,
                bar width=0.8
            ]
                \ifnum#1>0
                    \addplot[
                        fill=studycolor1
                    ] coordinates {
                        (0, 0)
                        (1, 0)
                        (2, 0)
                        (3, 30)
                        (4, 26)
                        (5, 13)
                    };
                \fi
                \ifnum#1>1
                    \addplot[
                        fill=studycolor2
                    ] coordinates {
                        (0, 106)
                        (1, 0)
                        (2, 0)
                        (3, 67)
                        (4, 20)
                        (5, 8)
                    };
                \fi
                \ifnum#1>2
                    \addplot[
                        fill=studycolor3
                    ] coordinates {
                        (0, 0)
                        (1, 0)
                        (2, 0)
                        (3, 30)
                        (4, 42)
                        (5, 15)
                    };
                \fi
                \ifnum#1>3
                    \addplot[
                        fill=studycolor4
                    ] coordinates {
                        (0, 0)
                        (1, 0)
                        (2, 0)
                        (3, 23)
                        (4, 2)
                        (5, 1)
                    };
                \fi
                \ifnum#1>4
                    \addplot[
                        fill=studycolor5
                    ] coordinates {
                        (0, 66)
                        (1, 0)
                        (2, 0)
                        (3, 0)
                        (4, 0)
                        (5, 0)
                    };
                \fi
                \ifnum#1>5
                    \addplot[
                        fill=studycolor6
                    ] coordinates {
                        (0, 21)
                        (1, 0)
                        (2, 0)
                        (3, 0)
                        (4, 0)
                        (5, 0)
                    };
                \fi
                \ifnum#1>6
                    \addplot[
                        fill=studycolor7
                    ] coordinates {
                        (0, 61)
                        (1, 0)
                        (2, 0)
                        (3, 0)
                        (4, 0)
                        (5, 0)
                    };
                \fi
                \ifnum#1>7
                    \addplot[
                        fill=studycolor8
                    ] coordinates {
                        (0, 0)
                        (1, 11)
                        (2, 0)
                        (3, 0)
                        (4, 0)
                        (5, 0)
                    };
                \fi
                \ifnum#1>8
                    \addplot[
                        fill=studycolor9
                    ] coordinates {
                        (0, 0)
                        (1, 48)
                        (2, 0)
                        (3, 0)
                        (4, 0)
                        (5, 0)
                    };
                \fi
                \ifnum#1>9
                    \addplot[
                        fill=studycolor10
                    ] coordinates {
                        (0, 1)
                        (1, 0)
                        (2, 25)
                        (3, 0)
                        (4, 0)
                        (5, 0)
                    };
                \fi
                \ifnum#1>10
                    \addplot[
                        fill=studycolor11
                    ] coordinates {
                        (0, 0)
                        (1, 0)
                        (2, 0)
                        (3, 32)
                        (4, 1)
                        (5, 3)
                    };
                \fi
                \ifnum#1>11
                    \addplot[
                        fill=studycolor12
                    ] coordinates {
                        (0, 0)
                        (1, 0)
                        (2, 0)
                        (3, 24)
                        (4, 0)
                        (5, 0)
                    };
                \fi
                \ifnum#1>12
                    \addplot[
                        fill=studycolor13
                    ] coordinates {
                        (0, 0)
                        (1, 0)
                        (2, 0)
                        (3, 13)
                        (4, 14)
                        (5, 35)
                    };
                \fi
            \end{axis}
        \end{tikzpicture}
    }
    \newsavebox{\wolfersdisorders}
    \sbox{\wolfersdisorders}{%
        \diagnosisplot{1}
    }

    \newsavebox{\arbabshiranidisorders}
    \sbox{\arbabshiranidisorders}{%
        \diagnosisplot{2}
    }

    \newsavebox{\rashiddisorders}
    \sbox{\rashiddisorders}{%
        \diagnosisplot{3}
    }

    \newsavebox{\quaakdisorders}
    \sbox{\quaakdisorders}{%
        \diagnosisplot{4}
    }

    \newsavebox{\demdisorders}
    \sbox{\demdisorders}{%
        \diagnosisplot{7}
    }

    \newsavebox{\msdisorders}
    \sbox{\msdisorders}{%
        \diagnosisplot{9}
    }

    \newsavebox{\pddisorders}
    \sbox{\pddisorders}{%
        \diagnosisplot{10}
    }

    \newsavebox{\sczdisorders}
    \sbox{\sczdisorders}{%
        \diagnosisplot{12}
    }

    \newsavebox{\mdddisorders}
    \sbox{\mdddisorders}{%
        \diagnosisplot{13}
    }

    \newcommand{\modalitystudies}[1]{
        \begin{tikzpicture}
            \begin{axis}[
                ybar stacked,
                xmin=-0.5,
                xmax=3.5,
                height=4cm,
                width=5.7cm,
                xlabel=\footnotesize{Modality},
                ylabel=\footnotesize{Studies},
                xtick={0, 1, 2, 3},
                xticklabels={sMRI,dMRI,fMRI,MOL},
                ticklabel style = {font=\scriptsize, text depth=0},
                xtick pos=bottom,
                axis y line*=left,
                axis x line*=bottom,
                ymin=0,
                ymax=380,
                bar width=0.8
            ]
                \ifnum#1>0
                    \addplot[
                        fill=studycolor1
                    ] coordinates {
                        (0, 34)
                        (1, 9)
                        (2, 45)
                        (3, 0)
                    };
                \fi
                \ifnum#1>1
                    \addplot[
                        fill=studycolor2
                    ] coordinates {
                        (0, 169)
                        (1, 21)
                        (2, 53)
                        (3, 13)
                    };
                \fi
                \ifnum#1>2
                    \addplot[
                        fill=studycolor3
                    ] coordinates {
                        (0, 36)
                        (1, 9)
                        (2, 42)
                        (3, 0)
                    };
                \fi
                \ifnum#1>3
                    \addplot[
                        fill=studycolor4
                    ] coordinates {
                        (0, 7)
                        (1, 0)
                        (2, 18)
                        (3, 0)
                    };
                \fi
                \ifnum#1>4
                    \addplot[
                        fill=studycolor5
                    ] coordinates {
                        (0, 42)
                        (1, 2)
                        (2, 3)
                        (3, 9)
                    };
                \fi
                \ifnum#1>5
                    \addplot[
                        fill=studycolor6
                    ] coordinates {
                        (0, 27)
                        (1, 0)
                        (2, 1)
                        (3, 4)
                    };
                \fi
                \ifnum#1>6
                    \addplot[
                        fill=studycolor7
                    ] coordinates {
                        (0, 44)
                        (1, 0)
                        (2, 4)
                        (3, 13)
                    };
                \fi
                \ifnum#1>7
                    \addplot[
                        fill=studycolor8
                    ] coordinates {
                        (0, 11)
                        (1, 0)
                        (2, 0)
                        (3, 0)
                    };
                \fi
                \ifnum#1>8
                    \addplot[
                        fill=studycolor9
                    ] coordinates {
                        (0, 36)
                        (1, 1)
                        (2, 4)
                        (3, 0)
                    };
                \fi
                \ifnum#1>9
                    \addplot[
                        fill=studycolor10
                    ] coordinates {
                        (0, 12)
                        (1, 0)
                        (2,1)
                        (3, 12)
                    };
                \fi
                \ifnum#1>10
                    \addplot[
                        fill=studycolor11
                    ] coordinates {
                        (0, 9)
                        (1, 0)
                        (2, 29)
                        (3, 0)
                    };
                \fi
                \ifnum#1>11
                    \addplot[
                        fill=studycolor12
                    ] coordinates {
                        (0, 10)
                        (1, 2)
                        (2, 12)
                        (3, 0)
                    };
                \fi
                \ifnum#1>12
                    \addplot[
                        fill=studycolor13
                    ] coordinates {
                        (0, 30)
                        (1, 4)
                        (2, 28)
                        (3, 0)
                    };
                \fi
            \end{axis}
        \end{tikzpicture}
    }
    \newsavebox{\wolfersmodalities}
    \sbox{\wolfersmodalities}{%
        \modalitystudies{1}
    }

    \newsavebox{\arbabshiranimodalities}
    \sbox{\arbabshiranimodalities}{%
        \modalitystudies{2}
    }

    \newsavebox{\rashidmodalities}
    \sbox{\rashidmodalities}{%
        \modalitystudies{3}
    }

    \newsavebox{\quaakmodalities}
    \sbox{\quaakmodalities}{%
        \modalitystudies{4}
    }

    \newsavebox{\demmodalities}
    \sbox{\demmodalities}{%
        \modalitystudies{7}
    }

    \newsavebox{\msmodalities}
    \sbox{\msmodalities}{%
        \modalitystudies{9}
    }

    \newsavebox{\pdmodalities}
    \sbox{\pdmodalities}{%
        \modalitystudies{10}
    }

    \newsavebox{\sczmodalities}
    \sbox{\sczmodalities}{%
        \modalitystudies{12}
    }

    \newsavebox{\mddmodalities}
    \sbox{\mddmodalities}{%
        \modalitystudies{13}
    }

    \begin{frame}[t]{Approach}
        \begin{tikzpicture}
            \node[draw=black] at (0, 0) {};
            \node[draw=black] at (10, -7) {};

            \only<1-6>{
                \only<1-2>{
                    \node[] at (5.9725, -2.9575) {
                        \scriptsize{DEM}
                    };
                    \node[] at (6.661, -2.96) {
                        \scriptsize{MS}
                    };
                    \node[] at (7.347, -2.96) {
                        \scriptsize{PD}
                    };
                    \node[] at (8.035, -2.963) {
                        \scriptsize{SCZ}
                    };
                    \node[] at (8.72, -2.96) {
                        \scriptsize{MDD}
                    };
                    \node[] at (9.405, -2.96) {
                        \scriptsize{BP}
                    };
                    \node[] at (7.69, -3.42) {
                        \footnotesize{Diagnosis}
                    };
                }
                \only<2>{
                    \node[align=left, font=\footnotesize, anchor=west] at (1, -5) {
                        (Non T1w) structural MRI (sMRI)\\
                        Diffusion MRI (dMRI)\\
                        Functional MRI (fMRI)\\
                        Molecular imaging (MOL)
                    };
                    \node[inner sep=0pt, outer sep=0pt] at (7.69, -6.93) {
                        \footnotesize{Modality}
                    };
                    \node[] at (6.145, -6.455) {
                        \scriptsize{sMRI}
                    };
                    \node[] at (7.175, -6.4585) {
                        \scriptsize{dMRI}
                    };
                    \node[] at (8.205, -6.4585) {
                        \scriptsize{fMRI}
                    };
                    \node[] at (9.235, -6.457) {
                        \scriptsize{MOL}
                    };
                }
                \onslide<3->{
                    \node[draw=black,inner sep=2pt] (wolfers) at (2, -1.8) {
                        \includegraphics[width=4cm]{data/wolfers_2015.png}
                    };
                    \only<3>{
                        \node[] at (7.2, -2) {
                            \usebox{\wolfersdisorders}
                        };
                        \node[] at (7.2, -5.5) {
                            \usebox{\wolfersmodalities}
                        };
                    }
                }
                \onslide<4->{
                    \node[draw=black,inner sep=2pt, anchor=north] (arbabshirani) at ($ (wolfers.south) - (0, 0.2) $) {
                        \includegraphics[width=4cm]{data/arbabshirani_2017.png}
                    };
                    \only<4>{
                        \node[] at (7.2, -2) {
                            \usebox{\arbabshiranidisorders}
                        };
                        \node[] at (7.2, -5.5) {
                            \usebox{\arbabshiranimodalities}
                        };
                    }
                }
                \onslide<5->{
                    \node[draw=black,inner sep=2pt, anchor=north] (rashid) at ($ (arbabshirani.south) - (0, 0.2) $) {
                        \includegraphics[width=4cm]{data/rashid_2020.png}
                    };
                    \only<5>{
                        \node[] at (7.2, -2) {
                            \usebox{\rashiddisorders}
                        };
                        \node[] at (7.2, -5.5) {
                            \usebox{\rashidmodalities}
                        };
                    }
                }
                \onslide<6->{
                    \node[draw=black,inner sep=2pt, anchor=north] (quaak) at ($ (rashid.south) - (0, 0.2) $) {
                        \includegraphics[width=4cm]{data/quaak_2021.png}
                    };
                    \only<6>{
                        \node[] at (7.2, -2) {
                            \usebox{\quaakdisorders}
                        };
                        \node[] at (7.2, -5.5) {
                            \usebox{\quaakmodalities}
                        };
                    }
                }
            }
            \only<7>{
                \node[draw=black,inner sep=2pt] (ebrahim) at (2, -2.2) {
                    \includegraphics[width=4cm]{data/ebrahimighahnavieh_2020.png}
                };
                \node[draw=black,inner sep=2pt, anchor=north] (mirzaei) at ($ (ebrahim.south) - (0, 0.2) $) {
                    \includegraphics[width=4cm]{data/mirzaei_2022.png}
                };

                \node[draw=black,inner sep=2pt, anchor=north] (fathi) at ($ (mirzaei.south) - (0, 0.2) $) {
                    \includegraphics[width=4cm]{data/fathi_2022.png}
                };
                \node[] at (7.2, -2) {
                    \usebox{\demdisorders}
                };
                \node[] at (7.2, -5.5) {
                    \usebox{\demmodalities}
                };
            }
            \only<8>{
                \node[draw=black,inner sep=2pt] (shoeibi) at (2, -2.8) {
                    \includegraphics[width=4cm]{data/shoeibi_2021.png}
                };
                \node[draw=black,inner sep=2pt, anchor=north] (aslam) at ($ (shoeibi.south) - (0, 0.2) $) {
                    \includegraphics[width=4cm]{data/aslam_2022.png}
                };
                \node[] at (7.2, -2) {
                    \usebox{\msdisorders}
                };
                \node[] at (7.2, -5.5) {
                    \usebox{\msmodalities}
                };
            }
            \only<9>{
                \node[draw=black,inner sep=2pt] (aggarwal) at (2, -3.5) {
                    \includegraphics[width=4cm]{data/aggarwal_2023.png}
                };
                \node[] at (7.2, -2) {
                    \usebox{\pddisorders}
                };
                \node[] at (7.2, -5.5) {
                    \usebox{\pdmodalities}
                };
            }
            \only<10>{
                \node[draw=black,inner sep=2pt] (filippis) at (2, -2.8) {
                    \includegraphics[width=4cm]{data/filippis_2019.png}
                };
                \node[draw=black,inner sep=2pt, anchor=north] (verma) at ($ (filippis.south) - (0, 0.2) $) {
                    \includegraphics[width=4cm]{data/verma_2023.png}
                };
                \node[] at (7.2, -2) {
                    \usebox{\sczdisorders}
                };
                \node[] at (7.2, -5.5) {
                    \usebox{\sczmodalities}
                };

            }
            \only<11>{
                \node[draw=black,inner sep=2pt] (aggarwal) at (2, -3.5) {
                    \includegraphics[width=4cm]{data/claude_2020.png}
                };
                \node[] at (7.2, -2) {
                    \usebox{\mdddisorders}
                };
                \node[] at (7.2, -5.5) {
                    \usebox{\mddmodalities}
                };
            }
        \end{tikzpicture}
    \end{frame}

    \newcommand{\modalityplot}[5]{
        \begin{tikzpicture}
            \begin{axis}[
                ymin=50,
                ymax=100,
                xtick=#2,
                xticklabels=#2,
                xlabel=\footnotesize{Year},
                ylabel=\footnotesize{Accuracy},
                width=4.5cm,
                height=4.5cm,
                every tick label/.append style={font=\footnotesize},
                xtick pos=bottom,
                ytick pos=left,
                clip=false,
                xmin=#3,
                xmax=#4
            ]
                \addplot[
                    only marks,
                    scatter,
                    scatter/classes={
                        DEM={mark=*,dem},
                        MS={mark=*,ms},
                        PD={mark=*,pd},
                        SCZ={mark=*,scz},
                        MDD={mark=*,mdd},
                        BP={mark=*,bp}
                    },
                    scatter src=explicit symbolic,
                    visualization depends on={ln(\thisrow{sample}*0.5) \as \perpointmarksize},
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\perpointmarksize
                    },
                    opacity=0.75
                ] table [
                    x=year,
                    y=accuracy,
                    col sep=comma,
                    meta=diagnosis
                ] {data/#1};
                #5
            \end{axis}
        \end{tikzpicture}
    }

    \newcommand{\disordermodalityplot}[7]{
        \begin{tikzpicture}
            \begin{axis}[
                ymin=50,
                ymax=100,
                xlabel=\footnotesize{Sample size},
                ylabel=\footnotesize{Accuracy},
                height=6cm,
                width=8cm,
                every tick label/.append style={font=\footnotesize},
                xmin=0,
                xmax=#5,
                xtick pos=bottom,
                ytick pos=left,
                title={#1 classification studies using #2}
            ]
                \addplot[
                    only marks,
                    discard if not={diagnosis}{#1},
                    mark=*,
                    #6,
                    opacity=0.75,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/#3};
                \addplot[
                    dashed,
                    #6
                ] coordinates {
                    (0, #4)
                    (#5, #4)
                };
                \node[anchor=north east, #6] at (axis cs: #7, #4) {\footnotesize{#4\%}};
            \end{axis}
        \end{tikzpicture}
    }

    \newsavebox{\ttwostudies}
    \sbox{\ttwostudies}{%
        \modalityplot{t2_studies.csv}{{2016, 2018, 2020, 2022}}{2015.5}{2022.5}{
            \node[circle,anchor=south west, draw=pd, fill=pd!75,inner sep=2pt,label=right:{\footnotesize{PD (4)}}] at (axis cs: 2023, 51) {};
            \node[circle,anchor=south west, draw=ms, fill=ms!75,inner sep=2pt,label=right:{\footnotesize{MS (18)}}] at (axis cs: 2023, 56) {};
        }
    }

    \newsavebox{\msflair}
    \sbox{\msflair}{%
        \disordermodalityplot{MS}{non-T1w sMRI}{t2_studies.csv}{92.42}{160}{ms}{145}
    }

    \newcommand{\ttwomsplot}[1]{
        \begin{tikzpicture}
            \begin{axis}[
                ymin=50,
                ymax=100,
                xlabel=\footnotesize{Sample size},
                ylabel=\footnotesize{Accuracy},
                height=6cm,
                width=8cm,
                every tick label/.append style={font=\footnotesize},
                xmin=0,
                xmax=160,
                xtick pos=bottom,
                ytick pos=left,
                title={MS classification studies using non-T1w sMRI}
            ]
            \ifnum#1>1
                \addplot[
                    only marks,
                    discard if not={ttwo}{0},
                    mark=*,
                    gray,
                    opacity=0.25,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/ms_t2_studies.csv};
                \addplot[
                    dashed,
                    gray,
                    opacity=0.25,
                ] coordinates {
                    (0, 92.57)
                    (160, 92.57)
                };
                \node[anchor=south east, gray] at (axis cs: 160, 92.57) {\footnotesize{92.57\%}};
            \fi
                \addplot[
                    only marks,
                    discard if not={ttwo}{1},
                    mark=*,
                    ms,
                    opacity=0.75,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/ms_t2_studies.csv};
                \addplot[
                    dashed,
                    ms
                ] coordinates {
                    (0, 92.42)
                    (1650, 92.42)
                };
                \node[anchor=north east, ms] at (axis cs: 145, 92.42) {\footnotesize{92.42\%}};


            \end{axis}
        \end{tikzpicture}
    }
    \newsavebox{\ttwomsttwo}
    \sbox{\ttwomsttwo}{%
        \ttwomsplot{1}
    }

    \newsavebox{\ttwomstall}
    \sbox{\ttwomstall}{%
        \ttwomsplot{2}
    }

    \newsavebox{\multimodalms}
    \sbox{\multimodalms}{%
        \begin{tikzpicture}
            \begin{axis}[
                ymin=50,
                ymax=100,
                xlabel=\footnotesize{Sample size},
                ylabel=\footnotesize{Accuracy},
                height=6cm,
                width=8cm,
                every tick label/.append style={font=\footnotesize},
                xmin=0,
                xmax=160,
                xtick pos=bottom,
                ytick pos=left,
                title={MS classification studies using non-T1w sMRI}
            ]
                \addplot[
                    only marks,
                    discard if not={diagnosis}{MS},
                    discard if not={multimodal}{0},
                    mark=*,
                    ms,
                    opacity=0.75,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/t2_studies.csv};
                \addplot[
                    dashed,
                    ms
                ] coordinates {
                    (0,92.42)
                    (160, 92.42)
                };
                \node[anchor=north east, ms] at (axis cs: 145, 92.42) {\footnotesize{92.42\%}};
                \addplot[
                    only marks,
                    discard if not={diagnosis}{MS},
                    discard if not={multimodal}{1},
                    mark=*,
                    gray,
                    opacity=0.75,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/t2_studies.csv};
            \end{axis}
        \end{tikzpicture}
    }

    \begin{frame}[t]{Other structural MRI modalities}
        \only<1-13>{
            \begin{tikzpicture}
                \def\labelsize{\footnotesize}

                \node[draw=black] at (0, 0) {};
                \node[draw=black] at (10, -7) {};
                \only<1-4>{
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                        Preson D. C., (2006), MRI Basics, https://case.edu/med/neurology/NR/MRI\%20Basics
                    };
                }
                \only<1-8>{
                    \node[anchor=west, inner sep=0pt, outer sep=0pt] (t1) at (0, -3.5) {
                        \includegraphics[
                            height=1.7cm
                        ]{data/t1.png}
                    };
                }
                \only<2-8>{
                    \node[anchor=west, inner sep=0pt, outer sep=0pt] (t2) at ($ (t1.east) $) {
                        \includegraphics[
                            height=1.7cm
                        ]{data/t2.png}
                    };
                }
                \only<3>{
                    \node[minimum width=0.4cm, minimum height=0.35cm, thick, draw=red] at ($ (t2) + (0, 0.225) $){};
                    \node[minimum width=0.4cm, minimum height=0.35cm, thick, draw=red] at ($ (t1) + (0, 0.225) $){};
                }
                \only<4-8>{
                    \node[anchor=west, inner sep=0pt, outer sep=0pt] (flair) at ($ (t2.east) $) {
                        \includegraphics[
                            height=1.7cm
                        ]{data/flair.png}
                    };
                }
                \only<5>{
                    \node[anchor=west] at (5, -3.5) {
                        \includegraphics[
                            height=3cm,
                            trim={0 2.8cm 5.6cm 0.2cm},
                            clip
                        ]{data/FLAIR_lesion_segmented.jpeg}
                    };
                }
                \only<6>{
                    \node[] at (7.1, -3.6) {
                        \usebox{\ttwostudies}
                    };
                };
                \only<7>{
                    \node[anchor=west] at (5, -3.5) {
                        \includegraphics[
                            height=3cm,
                            trim={0 2.8cm 3.7cm 0.2cm},
                            clip
                        ]{data/FLAIR_lesion_segmented.jpeg}
                    };
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                        Weeda, M. M., Brouwer, I., de Vos, M. L., de Vries, M. S., Barkhof, F., Pouwels, P. J. W., \& Vrenken, H. (2019). Comparing\\lesion segmentation methods in multiple sclerosis: Input from one manually delineated subject is sufficient for accurate\\lesion segmentation. NeuroImage: Clinical, 24, 102074
                    };
                }
                \only<8>{
                    \node[inner sep=0pt, draw=black] at (7.6, -3.2) {
                        \includegraphics[width=4.5cm]{data/ms_criteria.png}
                    };
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                        De Angelis, F., Brownlee, W. J., Chard, D. T., \& Trip, S. A. (2019). New MS diagnostic criteria in practice. Practical Neurology,\\19(1), 64-67
                    };
                }
                \only<9>{
                    \node[] at (5, -3.5) {
                        \usebox{\ttwomsttwo}
                    };
                }
                \only<10>{
                    \node[] at (5, -3.5) {
                        \usebox{\ttwomstall}
                    };
                }
                \only<11>{
                    \node[] at (5, -3.5) {
                        \usebox{\multimodalms}
                    };
                }
                \only<12-13>{
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                        Storelli, L., Azzimonti, M., Gueye, M., Vizzino, C., Preziosa, P., Tedeschi, G., ... \& Rocca, M. A. (2022). A deep learning\\approach to predicting disease progression in multiple sclerosis using magnetic resonance imaging. Investigative Radiology,\\57(7), 423-432
                    };
                }
                \only<12>{
                    \node[inner sep=0pt, draw=black] at (5, -3.5) {
                        \includegraphics[width=7.5cm]{data/storelli_model.jpeg}
                    };
                }
                \only<13>{
                    \node[inner sep=0pt, draw=black] at (5, -3.5) {
                        \includegraphics[width=9cm]{data/storelli_results.png}
                    };
                    \node[minimum width=0.3cm, minimum height=0.18cm, draw=red, inner sep=0pt, thick] at (7.42, -2.475) {};
                    \node[minimum width=0.3cm, minimum height=0.18cm, draw=red, inner sep=0pt, thick] at (7.42, -3.575) {};
                }
            \end{tikzpicture}
        }
        \only<14>{
            \vspace{\summarytop}
            \begin{itemize}[itemsep=\summaryouteritems]
                \item[\textbullet] {\footnotesize (Non T1-weighted) structural MRI}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textbullet] {\scriptsize Most prevalent in studies classifying MS and PD, yielding high accuracies ($\sim$90\%).}
                    \item[\textbullet] {\scriptsize T2 intimately linked with MS due to its efficacy at exposing characteristic lesions.}
                    \item[\textbullet] {\scriptsize Machine learning models trained on T1 and T2-weighted scans shown by Storelli et al.}
                    \item[] {\scriptsize to predict prognosis better than expert humans.}
                \end{itemize}
            \end{itemize}
        }
    \end{frame}

    \newsavebox{\dmristudies}
    \sbox{\dmristudies}{%
        \modalityplot{dmri_studies.csv}{{2005, 2010, 2015, 2020}}{2005}{2022}{
            \node[circle,anchor=south west, draw=ms, fill=ms!75,inner sep=2pt,label=right:{\footnotesize{MS (1)}}] at (axis cs: 2023, 51) {};
            \node[circle,anchor=south west, draw=bp, fill=bp!75,inner sep=2pt,label=right:{\footnotesize{BP (5)}}] at (axis cs: 2023, 56) {};
            \node[circle,anchor=south west, draw=dem, fill=dem!75,inner sep=2pt,label=right:{\footnotesize{DEM (6)}}] at (axis cs: 2023, 61) {};
            \node[circle,anchor=south west, draw=mdd, fill=mdd!75,inner sep=2pt,label=right:{\footnotesize{MDD (9)}}] at (axis cs: 2023, 66) {};
            \node[circle,anchor=south west, draw=scz, fill=scz!75,inner sep=2pt,label=right:{\footnotesize{SCZ (10)}}] at (axis cs: 2023, 71) {};
        }
    }

    \newsavebox{\dmridisorders}
    \sbox{\dmridisorders}{%
    \begin{tikzpicture}
        \begin{axis}[
            ymin=50,
            ymax=100,
            xlabel=\footnotesize{Sample size},
            ylabel=\footnotesize{Accuracy},
            height=6cm,
            width=8cm,
            every tick label/.append style={font=\footnotesize},
            xmin=0,
            xmax=320,
            xtick pos=bottom,
            ytick pos=left,
            title={Classification studies of mental disorders using dMRI}
        ]
            \addplot[
                only marks,
                discard if not={diagnosis}{SCZ},
                mark=*,
                scz,
                opacity=0.75,
                mark size=3pt
            ] table [
                x=sample,
                y=accuracy,
                col sep=comma,
            ] {data/dmri_studies.csv};
            \addplot[
                dashed,
                scz
            ] coordinates {
                (0, 84.2)
                (320, 84.2)
            };
            \node[anchor=north east, scz] at (axis cs: 300, 84.2) {\footnotesize{SCZ: 84.30\%}};
            \addplot[
                only marks,
                discard if not={diagnosis}{MDD},
                mark=*,
                mdd,
                opacity=0.75,
                mark size=3pt
            ] table [
                x=sample,
                y=accuracy,
                col sep=comma,
            ] {data/dmri_studies.csv};
            \addplot[
                dashed,
                mdd
            ] coordinates {
                (0, 84.38)
                (320, 84.38)
            };
            \node[anchor=south east, mdd] at (axis cs: 300, 84.38) {\footnotesize{MDD: 84.38\%}};
            \addplot[
                only marks,
                discard if not={diagnosis}{BP},
                mark=*,
                bp,
                opacity=0.75,
                mark size=3pt
            ] table [
                x=sample,
                y=accuracy,
                col sep=comma,
            ] {data/dmri_studies.csv};
            \addplot[
                dashed,
                bp
            ] coordinates {
                (0, 79.32)
                (320, 79.32)
            };
            \node[anchor=north east, bp] at (axis cs: 300, 79.32) {\footnotesize{BP: 79.32\%}};
        \end{axis}
    \end{tikzpicture}
    }

    \newsavebox{\dmripredictions}
    \sbox{\dmripredictions}{%
        \begin{tikzpicture}
            \begin{axis}[
                xmin=2000,
                xmax=2024,
                ymin=0,
                height=4.75cm,
                width=5.75cm,
                xlabel=\footnotesize{Year},
                ylabel=\footnotesize{Pubmed publications},
                every tick label/.append style={font=\footnotesize},
                xtick={2000, 2010, 2020},
                xticklabels={2000, 2010, 2020},
                xtick pos=bottom,
                ytick pos=left
            ]
                \addplot[
                    very thick,
                    color1
                ] table [
                    x=Year,
                    y=Count,
                    col sep=comma
                ] {data/dmri_ml.csv};
                \addplot[
                    thick,
                    color3
                ] table [
                    x=Year,
                    y=Count,
                    col sep=comma
                ] {data/fmri_ml.csv};
                \addplot[
                    thick,
                    color5
                ] table [
                    x=Year,
                    y=Count,
                    col sep=comma
                ] {data/smri_ml.csv};
                \addplot[
                    thick,
                    color7
                ] table [
                    x=Year,
                    y=Count,
                    col sep=comma
                ] {data/pet_ml.csv};
                \node[anchor=west, text depth=0, inner sep=2pt] (mol) at (axis cs: 2002, 580) {\scriptsize{MOL}};
                \draw[thick, color7] ($ (mol.west) - (1.5, 0) $) -- (mol.west);
                \node[anchor=west, text depth=0, inner sep=2pt] (smri) at (axis cs: 2002, 540) {\scriptsize{sMRI}};
                \draw[thick, color5] ($ (smri.west) - (1.5, 0) $) -- (smri.west);
                \node[anchor=west, text depth=0, inner sep=2pt] (fmri) at (axis cs: 2002, 500) {\scriptsize{fMRI}};
                \draw[thick, color3] ($ (fmri.west) - (1.5, 0) $) -- (fmri.west);
                \node[anchor=west, text depth=0, inner sep=2pt] (dmri) at (axis cs: 2002, 460) {\scriptsize{dMRI}};
                \draw[very thick, color1] ($ (dmri.west) - (1.5, 0) $) -- (dmri.west);
            \end{axis}
        \end{tikzpicture}
    }

    \newcommand{\drawwater}[3]{
        % Draw oxygen
        \node[draw, circle, fill=red, minimum size=3mm, inner sep=0pt] (#3) at (#1,#2) {};
        % Calculate positions for hydrogen
        \pgfmathsetmacro{\angleone}{random()*360}
        \pgfmathsetmacro{\angletwo}{\angleone + 104.5} % 104.5 degrees is the angle in a water molecule
        % Draw hydrogens
        \node[draw, circle, fill=white, minimum size=1.5mm, inner sep=0pt] (H1) at ($(#3) + (\angleone:0.3)$) {};
        \node[draw, circle, fill=white, minimum size=1.5mm, inner sep=0pt] (H2) at ($(#3) + (\angletwo:0.3)$) {};
        % Connect hydrogens to oxygen
        \draw (#3) -- (H1);
        \draw (#3) -- (H2);
    }

    \newcommand{\drawdiffusion}[1]{
        \begin{tikzpicture}
            % Random seed for reproducibility
            \pgfmathsetseed{6}

            \drawwater{1}{3}{a}
            \drawwater{1.5}{4}{b}
            \drawwater{0.5}{2.5}{c}
            \drawwater{0.75}{3.75}{d}
            \drawwater{1.5}{3.5}{e}
            \drawwater{2}{2.5}{f}
            \drawwater{1.25}{2.25}{g}
            \node[] at (-0.5, 1.25) {};
            \node[] at (3, 5) {};

            \ifnum#1=2
                \draw[-stealth] (a) -- ($ (a) + (-0.1, -0.5) $);
                \draw[-stealth] (b) -- ($ (b) + (0.3, 0.4) $);
                \draw[-stealth] (c) -- ($ (c) + (-0.2, -0.4) $);
                \draw[-stealth] (d) -- ($ (d) + (-0.4, 0.2) $);
                \draw[-stealth] (e) -- ($ (e) + (-0.5, 0.2) $);
                \draw[-stealth] (f) -- ($ (f) + (0.3, 0.4) $);
                \draw[-stealth] (g) -- ($ (g) + (0.0, -0.5) $);
            \fi
            \ifnum#1=3
                \draw[-stealth] (a) -- ($ (a) + (-0.1, 0.5) $);
                \draw[-stealth] (b) -- ($ (b) + (0.2, 0.45) $);
                \draw[-stealth] (c) -- ($ (c) + (0.05, 0.5) $);
                \draw[-stealth] (d) -- ($ (d) + (-0.2, 0.4) $);
                \draw[-stealth] (e) -- ($ (e) + (-0.2, 0.4) $);
                \draw[-stealth] (f) -- ($ (f) + (0.1, 0.4) $);
                \draw[-stealth] (g) -- ($ (g) + (-0.2, 0.5) $);

                \pgfmathsetmacro{\xmin}{0} % Minimum x-coordinate of the molecules
                \pgfmathsetmacro{\xmax}{2.3}   % Maximum x-coordinate of the molecules

                % Draw curving side boundaries
                \draw[thick, name path=leftinner] plot [smooth] coordinates {(\xmin+0.1, 1.5) (\xmin-0.1, 3) (\xmin+0.1, 4.5)};
                \draw[thick, name path=leftouter] plot [smooth] coordinates {(\xmin+0.2, 1.5) (\xmin, 3) (\xmin+0.2, 4.5)};
                \draw[thick] plot [smooth] coordinates {(\xmax+0.2, 1.5) (\xmax, 3) (\xmax+0.2, 4.5)};
                \draw[thick] plot [smooth] coordinates {(\xmax+0.3, 1.5) (\xmax+0.1, 3) (\xmax+0.3, 4.5)};
            \fi
        \end{tikzpicture}
    }

    \newsavebox{\waterfree}
    \sbox{\waterfree}{%
        \drawdiffusion{1}
    }
    \newsavebox{\watermoving}
    \sbox{\watermoving}{%
        \drawdiffusion{2}
    }
    \newsavebox{\waterboundary}
    \sbox{\waterboundary}{%
        \drawdiffusion{3}
    }

    \begin{frame}[t]{Diffusion MRI}
        \only<1-12>{
            \begin{tikzpicture}
                \node[] at (0, 0) {};
                \node[] at (10, -7) {};

                \only<1-9>{
                    \onslide<1->{
                        \node[anchor=west, inner sep=0pt, outer sep=0pt] (t1) at (0.5, -2.5) {
                            \includegraphics[
                                height=2cm
                            ]{data/dti_t1.png}
                        };
                    }
                    \only<2>{
                        \node[] at (7.5, -3.5) {
                            \usebox{\waterfree}
                        };
                    }
                    \only<3>{
                        \node[] at (7.5, -3.5) {
                            \usebox{\watermoving}
                        };
                    }
                    \only<4>{
                        \node[] at (7.5, -3.5) {
                            \usebox{\waterboundary}
                        };
                    }
                    \onslide<5->{
                        \node[anchor=west, inner sep=0pt, outer sep=0pt] (fa) at ($ (t1.east) - (0.05, 0) $) {
                            \includegraphics[
                                height=2cm
                            ]{data/dti_fa.png}
                        };
                    }
                    \onslide<6->{
                        \node[anchor=north, inner sep=0pt, outer sep=0pt] (md) at ($ (t1.south) + (0, 0.05) $) {
                            \includegraphics[
                                height=2cm
                            ]{data/dti_md.png}
                        };
                    }
                    \onslide<7->{
                        \node[anchor=west, inner sep=0pt, outer sep=0pt] (fa) at ($ (md.east) - (0.05, 0) $) {
                            \includegraphics[
                                height=2cm
                            ]{data/dti_tract.png}
                        };
                    }
                }
                \only<8>{
                    \node[] at (7.6, -3.6) {
                        \usebox{\dmristudies}
                    };
                };
                \only<9>{
                    \node[] at (7.4, -3.43) {
                        \usebox{\dmripredictions}
                    };
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] at (5, -7.65) {
                        \begin{tabular}{rl}
                            MOL:&((molecular[Title] AND imaging[Title]) OR PET[Title] OR SPECT[Title]) AND (machine learning OR ML \\
                            &OR deep learning OR DL OR prediction)"\\
                            sMRI:&((structural[Title] AND MRI[Title]) OR sMRI[Title] OR T1[Title] OR T2[Title]) AND (machine learning OR ML\\
                            &OR deep learning OR DL OR prediction)\\
                            fMRI:&((functional[Title] AND MRI[Title]) OR fMRI[Title]) AND (machine learning OR ML OR deep learning OR DL\\
                            &OR prediction)\\
                            dMRI:&((diffusion[Title] AND MRI[Title]) OR dMRI[Title] OR DTI[Title]) AND (machine learning OR ML OR deep learning\\
                            &OR DL OR prediction)\\
                        \end{tabular}
                    };
                }
                \onslide<10-14>{
                    \only<10>{
                        \node[] at (5, -3.2) {
                            \usebox{\dmridisorders}
                        };
                    }
                    \onslide<11->{
                        \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                            Saglam, Y., Oz, A., Yildiz, G., Ermis, C., Kargin, O. A., Arslan, S., \& Karacetin, G. (2023). Can diffusion\\tensor imaging have a diagnostic utility to differentiate early-onset forms of bipolar disorder and schizophrenia:\\A neuroimaging study with explainable machine learning algorithms. Psychiatry Research: Neuroimaging, 335, 111696
                        };
                    }
                    \only<11>{
                        \node[inner sep=0pt, draw=black] at (5, -3.2) {
                            \includegraphics[width=5cm]{data/scz_bp_pipeline.png}
                        };
                    }
                    \only<12>{
                        \node[inner sep=0pt, draw=black] at (5, -3.2) {
                            \includegraphics[width=9cm]{data/scz_bp_performance.png}
                        };
                        \node[minimum width=0.45cm, minimum height=0.24cm, draw=red, inner sep=0pt, thick] at (3.41, -2.45) {};
                    }
                }
            \end{tikzpicture}
        }
        \only<13>{
            \vspace{\summarytop}
            \begin{itemize}[itemsep=\summaryouteritems]
                \item[\textcolor{gray!50}{\textbullet}] {\footnotesize \textcolor{gray!50}{(Non T1-weighted) structural MRI (T2/FLAIR)}}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textcolor{gray!50}{\textbullet}] \textcolor{gray!50}{\scriptsize{Most prevalent in studies classifying MS and PD, yielding high accuracies ($\sim$90\%).}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Intimately linked with MS due to their efficacy at exposing characteristic lesions.}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Potentially more useful than T1-weighted MRI for differentially diagnosing PD and PSP,}}
                    \item[] {\scriptsize \textcolor{gray!50}{as demonstrated by Talai et al.}}
                \end{itemize}
                \item[\textbullet] {\footnotesize Diffusion MRI}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textbullet] {\scriptsize Relatively few prediction studies found. Those that exist are for various disorders,}
                    \item[] {\scriptsize mostly mental disorders (SCZ, MDD, BP) with varying accuracies (60-100\%).}
                    \item[\textbullet] {\scriptsize Used by Saglam et al. to differentially diagnose SCZ and BP with 80\% accuracy.}
                \end{itemize}
            \end{itemize}
        }
    \end{frame}

    \newsavebox{\fmristudies}
    \sbox{\fmristudies}{%
        \modalityplot{fmri_studies.csv}{{2005, 2010, 2015, 2020}}{2005}{2023}{
                \node[circle,anchor=south west, draw=pd, fill=pd!75,inner sep=2pt,label=right:{\footnotesize{PD (1)}}] at (axis cs: 2024, 51) {};
                \node[circle,anchor=south west, draw=ms, fill=ms!75,inner sep=2pt,label=right:{\footnotesize{MS (4)}}] at (axis cs: 2024, 56) {};
                \node[circle,anchor=south west, draw=bp, fill=bp!75,inner sep=2pt,label=right:{\footnotesize{BP (5)}}] at (axis cs: 2024, 61) {};
                \node[circle,anchor=south west, draw=dem, fill=dem!75,inner sep=2pt,label=right:{\footnotesize{DEM (12)}}] at (axis cs: 2024, 66) {};
                \node[circle,anchor=south west, draw=mdd, fill=mdd!75,inner sep=2pt,label=right:{\footnotesize{MDD (34)}}] at (axis cs: 2024, 71) {};
                \node[circle,anchor=south west, draw=scz, fill=scz!75,inner sep=2pt,label=right:{\footnotesize{SCZ (96)}}] at (axis cs: 2024, 76) {};
        }
    }

    \newsavebox{\mddfmri}
    \sbox{\mddfmri}{%
        \disordermodalityplot{MDD}{fMRI}{fmri_studies.csv}{81.99}{380}{mdd}{380}
    }

    \newcommand{\casecontrolplot}[1]{
        \begin{tikzpicture}
            \node[] at (0, 0) {};
            \node[] at (8, -5) {};

            \stickman{(0.5, -2.5)}{blue}
            \stickman{(7.5, -2.5)}{red}

            \ifnum#1>1
                \node [
                    double arrow,
                    left color=blue,
                    right color=red,
                    single arrow head extend=3pt,
                    transform shape,
                    minimum height=2cm,
                    text width=6.45cm,
                    anchor=west
                ] at (0.5, -3.75){};
                \node[white] at (4, -3.75) {\scriptsize{Symptom severity}};

                \stickman{(1.5, -2.5)}{red!14!blue}
                \stickman{(6.5, -2.5)}{red!84!blue}
                \ifnum#1=2
                    \stickman{(2.5, -2.5)}{red!28!blue}
                    \stickman{(3.5, -2.5)}{red!42!blue}
                    \stickman{(4.5, -2.5)}{red!56!blue}
                    \stickman{(5.5, -2.5)}{red!70!blue}
                \fi
                \ifnum#1=3
                    \stickman{(2.5, -2.5)}{red!28!blue!25!white}
                    \stickman{(3.5, -2.5)}{red!42!blue!25!white}
                    \stickman{(4.5, -2.5)}{red!56!blue!25!white}
                    \stickman{(5.5, -2.5)}{red!70!blue!25!white}
                \fi
            \fi
        \end{tikzpicture}
    }

    \newsavebox{\casecontrolmdd}
    \sbox{\casecontrolmdd}{%
        \casecontrolplot{1}
    }

    \newsavebox{\dimensionalmdd}
    \sbox{\dimensionalmdd}{%
        \casecontrolplot{2}
    }
    \newsavebox{\simplemdd}
    \sbox{\simplemdd}{%
        \casecontrolplot{3}
    }

    \begin{frame}[t]{Functional Magnetic Resonance Imaging (fMRI)}
        \only<1-11>{
            \begin{tikzpicture}
                \node[] at (0, 0) {};
                \node[] at (10, -7) {};
                \only<1>{
                    \node[anchor=west] at (1, -3.5) {
                        \includegraphics[
                            height=3cm,
                            trim={75 210 590 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                }
                \only<2,4>{
                    \node[anchor=west] at (1, -3.5) {
                        \includegraphics[
                            height=3cm,
                            trim={595 210 80 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                }
                \only<3>{
                    \node[anchor=west] at (0, -2.5) {
                        \includegraphics[
                            height=3cm,
                            trim={75 210 590 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                    \node[anchor=west] (first) at (0, -2.5) {
                        \includegraphics[
                            height=3cm,
                            trim={595 210 80 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                    \node[anchor=west] at (0.5, -3.0) {
                        \includegraphics[
                            height=3cm,
                            trim={75 210 590 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                    \node[anchor=west] at (0.5, -3.0) {
                        \includegraphics[
                            height=3cm,
                            trim={595 210 80 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                    \node[anchor=west] at (1, -3.5) {
                        \includegraphics[
                            height=3cm,
                            trim={75 210 590 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                    \node[anchor=west] at (1, -3.5) {
                        \includegraphics[
                            height=3cm,
                            trim={595 210 80 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                    \node[anchor=west] at (1.5, -4) {
                        \includegraphics[
                            height=3cm,
                            trim={75 210 590 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                    \node[anchor=west] at (1.5, -4) {
                        \includegraphics[
                            height=3cm,
                            trim={595 210 80 70},
                            clip
                        ]{data/smri_fmri.png}
                    };
                    \node[anchor=west] at (2, -4.5) {
                        \includegraphics[
                            height=3cm,
                            trim={75 210 590 70},
                            clip
                        ]{data/smri_fmri.png}
                    };

                    \node[anchor=west] (last) at (2, -4.5) {
                        \includegraphics[
                            height=3cm,
                            trim={595 210 80 70},
                            clip
                        ]{data/smri_fmri.png}
                    };

                    \draw[-stealth] ($ (first.north east) + (0.5, -0.13) $) -- ($ (last.north east) + (0.5, -0.13) $) node[midway, above, rotate=315] {time};
                }
                \only<4>{
                    \node[] at (7.6, -3.6) {
                        \usebox{\fmristudies}
                    };
                }
                \only<5-6>{
                    \node[] at (5, -3.6) {
                        \usebox{\mddfmri}
                    };
                }
                \only<6>{
                    \node[circle, draw=red, thick, fill=none, inner sep=5pt] at (8.4, -5.68) {};
                }

                \only<6-8>{
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                        Sundermann, B., Feder, S., Wersching, H., Teuber, A., Schwindt, W., Kugel, H., ... \& Pfleiderer, B. (2017). Diagnostic classification of\\unipolar depression based on resting-state functional connectivity MRI: effects of generalization to a diverse sample. Journal\\of Neural Transmission, 124, 589-605
                    };
                }

                \only<7>{
                    \node[inner sep=0pt, draw=black] at (5, -3.2) {
                        \includegraphics[width=5cm]{data/fmri_depression_pipeline.png}
                    };
                    \node[minimum width=2.85cm, minimum height=0.3cm, draw=red, inner sep=0pt, thick] at (5.67, -6.26) {};
                }
                \only<8>{
                    \node[inner sep=0pt, draw=black] at (5, -3.2) {
                        \includegraphics[width=9cm]{data/fmri_depression_results.png}
                    };
                    \node[minimum width=1.5cm, minimum height=0.45cm, draw=red, inner sep=0pt, thick] at (1.27, -2.2) {};
                    \draw[thick, red] (1.8, -2.67) -- (4.25, -2.67) {};
                    \node[minimum width=0.3cm, minimum height=0.2cm, draw=red, inner sep=0pt, thick] at (6.425, -4.265) {};
                }
                \only<9>{
                    \node[] at (5, -3.5) {
                        \usebox{\casecontrolmdd}
                    };
                }
                \only<10>{
                    \node[] at (5, -3.5) {
                        \usebox{\dimensionalmdd}
                    };
                }
                \only<11>{
                    \node[] at (5, -3.5) {
                        \usebox{\simplemdd}
                    };
                }
            \end{tikzpicture}
        }
        \only<12>{
            \vspace{\summarytop}
            \begin{itemize}[itemsep=\summaryouteritems]
                \item[\textcolor{gray!50}{\textbullet}] {\footnotesize \textcolor{gray!50}{(Non T1-weighted) structural MRI (T2/FLAIR)}}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textcolor{gray!50}{\textbullet}] \textcolor{gray!50}{\scriptsize{Most prevalent in studies classifying MS and PD, yielding high accuracies ($\sim$90\%).}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Intimately linked with MS due to their efficacy at exposing characteristic lesions.}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Potentially more useful than T1-weighted MRI for differentially diagnosing PD and PSP,}}
                    \item[] {\scriptsize \textcolor{gray!50}{as demonstrated by Talai et al.}}
                \end{itemize}
                \item[\textcolor{gray!50}{\textbullet}] {\footnotesize \textcolor{gray!50}{Diffusion MRI}}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Relatively few prediction studies found. Those that exist are for various disorders,}}
                    \item[] {\scriptsize \textcolor{gray!50}{mostly mental disorders (with varying accuracies, 60-100\%) and DEM (80-100\%).}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Used by Saglam et al. to differentially diagnose SCZ and BP with 80\% accuracy.}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Used by Sun et al. to predict conversion from MCI to DEM with 81\% accuracy.}}
                \end{itemize}
                \item[\textbullet] {\footnotesize Functional MRI}
            \end{itemize}
        }
    \end{frame}

    \newsavebox{\molstudies}
    \sbox{\molstudies}{%
        \modalityplot{molecular_studies.csv}{{2014, 2018, 2022}}{2011}{2023}{
            \node[circle,anchor=south west, draw=pd, fill=pd!75,inner sep=2pt,label=right:{\footnotesize{PD (12)}}] at (axis cs: 2024, 51) {};
            \node[circle,anchor=south west, draw=dem, fill=dem!75,inner sep=2pt,label=right:{\footnotesize{DEM (23)}}] at (axis cs: 2024, 56) {};
        }
    }

    \newcommand{\moldemplot}[1]{
        \begin{tikzpicture}
            \begin{axis}[
                ymin=50,
                ymax=100,
                xlabel=\footnotesize{Sample size},
                ylabel=\footnotesize{Accuracy},
                height=6cm,
                width=8cm,
                every tick label/.append style={font=\footnotesize},
                xmin=0,
                xmax=2900,
                xtick pos=bottom,
                ytick pos=left,
                title={DEM classification studies using molecular imaging}
            ]
            \ifnum#1>1
                \addplot[
                    only marks,
                    discard if not={pet}{0},
                    mark=*,
                    gray,
                    opacity=0.25,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/ad_pet_studies.csv};
                \addplot[
                    dashed,
                    gray,
                    opacity=0.25,
                ] coordinates {
                    (0, 91.63)
                    (2900, 91.63)
                };
                \node[anchor=north east, gray] at (axis cs: 2900, 91.63) {\footnotesize{91.63\%}};
            \fi
                \addplot[
                    only marks,
                    discard if not={pet}{1},
                    mark=*,
                    dem,
                    opacity=0.75,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/ad_pet_studies.csv};
                \addplot[
                    dashed,
                    dem
                ] coordinates {
                    (0, 92.66)
                    (2900, 92.66)
                };
                \node[anchor=south east, dem] at (axis cs: 2900, 92.66) {\footnotesize{92.66\%}};


            \end{axis}
        \end{tikzpicture}
    }
    \newsavebox{\moldempet}
    \sbox{\moldempet}{%
        \moldemplot{1}
    }

    \newsavebox{\moldemall}
    \sbox{\moldemall}{%
        \moldemplot{2}
    }

    \newcommand{\molpdplot}[1]{
        \begin{tikzpicture}
            \begin{axis}[
                ymin=50,
                ymax=100,
                xlabel=\footnotesize{Sample size},
                ylabel=\footnotesize{Accuracy},
                height=6cm,
                width=8cm,
                every tick label/.append style={font=\footnotesize},
                xmin=0,
                xmax=1650,
                xtick pos=bottom,
                ytick pos=left,
                title={PD classification studies using molecular imaging}
            ]
            \ifnum#1>1
                \addplot[
                    only marks,
                    discard if not={pet}{0},
                    mark=*,
                    gray,
                    opacity=0.25,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/pd_pet_studies.csv};
                \addplot[
                    dashed,
                    gray,
                    opacity=0.25,
                ] coordinates {
                    (0, 92.81)
                    (1650, 92.81)
                };
                \node[anchor=south east, gray] at (axis cs: 1450, 92.81) {\footnotesize{92.81\%}};
            \fi
                \addplot[
                    only marks,
                    discard if not={pet}{1},
                    mark=*,
                    pd,
                    opacity=0.75,
                    mark size=3pt
                ] table [
                    x=sample,
                    y=accuracy,
                    col sep=comma,
                ] {data/pd_pet_studies.csv};
                \addplot[
                    dashed,
                    pd
                ] coordinates {
                    (0, 92.02)
                    (1650, 92.02)
                };
                \node[anchor=north east, pd] at (axis cs: 1650, 92.02) {\footnotesize{92.02\%}};


            \end{axis}
        \end{tikzpicture}
    }
    \newsavebox{\molpdpet}
    \sbox{\molpdpet}{%
        \molpdplot{1}
    }

    \newsavebox{\molpdall}
    \sbox{\molpdall}{%
        \molpdplot{2}
    }

    \newsavebox{\molpdspect}
    \sbox{\molpdspect}{%
        \disordermodalityplot{PD}{molecular imaging}{molecular_studies.csv}{92.02}{1650}{pd}{1650}
    }

    \newcommand{\drawarcs}[2]{
        \foreach \radius in {0.2, 0.4, 0.6} {
            % Adjust starting and ending angles to center the arc around the direction
            \draw[red, very thick, opacity=0.5] (#1) ++(#2-60:\radius) arc (#2-60:#2+60:\radius);
        }
    }

    \newcommand{\molschematic}[1]{
        \begin{tikzpicture}
            \pgfmathsetseed{3} % Seed for reproducibility, remove or change for different patterns

            % Drawing the diagonal separation
            \fill[gray!50] (0,0) -- (6,0) -- (0,3) -- cycle; % Gray matter
            \fill[gray!20] (0,3) -- (6,0) -- (6,3) -- cycle; % White matter

            \node[] at (-1, -1) {};
            \node[] at (7, 4) {};

            % Neurons in gray matter
            \foreach \i in {1,...,240} {
                \pgfmathsetmacro{\x}{rand*3 + 3} % generate x within 0 to 6
                \pgfmathsetmacro{\y}{rand*1.5 + 1.5} % generate y within 0 to 3
                % Ensuring neurons are within the gray triangle
                \pgfmathparse{\y < -0.5*\x + 3 ? 1 : 0}
                \ifnum\pgfmathresult>0
                    \fill [black, opacity=0.5] (\x, \y) circle (0.12);
                \fi
            }

            % Neurons in white matter
            \foreach \i in {1,...,40} {
                \pgfmathsetmacro{\x}{rand*3 + 3} % generate x within 0 to 6
                \pgfmathsetmacro{\y}{rand*1.5 + 1.5} % adjust y to properly randomize within the higher triangle
                % Ensuring neurons are within the white triangle
                \pgfmathparse{\y > -0.5*\x + 3 ? 1 : 0}
                \ifnum\pgfmathresult>0
                    \fill [black, opacity=0.5] (\x, \y) circle (0.12);
                \fi
            }

            \ifnum#1>1
                \node[fill=green, minimum size=4pt, circle, inner sep=0pt] at (1, 0.95) {};
                \node[fill=green, minimum size=4pt, circle, inner sep=0pt] at (1.5, 1.9) {};
                \node[fill=green, minimum size=4pt, circle, inner sep=0pt] at (4, 0.8) {};
                \node[fill=green, minimum size=4pt, circle, inner sep=0pt] at (3.5, 2.5) {};
                \node[fill=green, minimum size=4pt, circle, inner sep=0pt] at (5.1, 2.8) {};
            \fi
            \ifnum#1=3
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] at (3, 2.9) {};
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] at (2.9, 2.85) {};
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] at (2.97, 3.05) {};
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] at (2.75, 3.03) {};
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] at (2.85, 2.7) {};
            \fi
            \ifnum#1>3
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] (a) at (1.05, 1.01) {};
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] (b) at (1.56, 1.98) {};
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] (c) at (3.95, 0.88) {};
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] (d) at (3.42, 2.53) {};
                \node[fill=red, minimum size=4pt, circle, inner sep=0pt] (e) at (5.0, 2.82) {};
            \fi
            \ifnum#1>4
                \drawarcs{a}{180} % First node, signal goes leftwards (180 degrees)
                \drawarcs{b}{90}  % Second node, signal goes upwards (90 degrees)
                \drawarcs{c}{270} % Third node, signal goes downwards (270 degrees)
                \drawarcs{d}{90}  % Fourth node, signal goes upwards (90 degrees)
                \drawarcs{e}{90}  % Fifth node, signal goes upwards (90 degrees)
            \fi
        \end{tikzpicture}
    }
    \newsavebox{\tone}
    \sbox{\tone}{%
        \molschematic{1}
    }

    \newsavebox{\tonemolecules}
    \sbox{\tonemolecules}{%
        \molschematic{2}
    }

    \newsavebox{\tonetracer}
    \sbox{\tonetracer}{%
        \molschematic{3}
    }

    \newsavebox{\tonebind}
    \sbox{\tonebind}{%
        \molschematic{4}
    }

    \newsavebox{\tonesignal}
    \sbox{\tonesignal}{%
        \molschematic{5}
    }

    \begin{frame}[t]{Molecular imaging}
        \def\petwidth{1.9cm}
        \only<1-18>{
            \begin{tikzpicture}
                \node[] at (0, 0) {};
                \node[] at (10, -7) {};

                \only<1-6>{
                    \node[] at (2, -3.5) {
                        \includegraphics[
                            width=2.5cm,
                            trim={4cm 3cm 60cm 6cm},
                            clip
                        ]{data/fdg_t1.png}
                    };
                }
                \only<2>{
                    \node[] at (7, -3.5) {
                        \usebox{\tone}
                    };
                }
                \only<3>{
                    \node[] at (7, -3.5) {
                        \usebox{\tonemolecules}
                    };
                }
                \only<4>{
                    \node[] at (7, -3.5) {
                        \usebox{\tonetracer}
                    };
                }
                \only<5>{
                    \node[] at (7, -3.5) {
                        \usebox{\tonebind}
                    };
                }
                \only<6>{
                    \node[] at (7, -3.5) {
                        \usebox{\tonesignal}
                    };
                }
                \only<7-8>{
                    \node[] at (2, -3.5) {
                        \includegraphics[
                            width=2.5cm,
                            trim={60cm 3cm 4cm 6cm},
                            clip
                        ]{data/fdg_t1.png}
                    };
                }
                \only<8>{
                    \node[] at (7.2, -3.6) {
                        \usebox{\molstudies}
                    };
                }
                \only<9-12>{
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                        Chételat, G., Arbizu, J., Barthel, H., Garibotto, V., Lammertsma, A. A., Law, I., ... \& Drzezga, A. (2021). Finding our way through the\\labyrinth of dementia biomarkers. European journal of nuclear medicine and molecular imaging, 48, 2320-2324
                    };
                    \node[anchor=west, inner sep=0pt, outer sep=0pt] (smri) at (0.4, -3.2) {
                        \includegraphics[
                            height=5cm
                        ]{data/AD_pet_types_smri.png}
                    };
                }
                \only<10-12>{
                    \node[anchor=west, inner sep=0pt, outer sep=0pt, fill=black, minimum width=\petwidth] (amyloid) at ($ (smri.east) - (0.05, 0) $) {
                        \includegraphics[
                            height=5cm
                        ]{data/AD_pet_types_amyloid.png}
                    };
                }
                \only<11-12>{
                    \node[anchor=west, inner sep=0pt, outer sep=0pt, fill=black, minimum width=\petwidth] (tau) at ($ (amyloid.east) - (0.05, 0) $) {
                        \includegraphics[
                            height=5cm
                        ]{data/AD_pet_types_tau.png}
                    };
                }
                \only<12>{
                    \node[anchor=west, inner sep=0pt, outer sep=0pt, fill=black, minimum width=\petwidth] (fdg) at ($ (tau.east) - (0.05, 0) $) {
                        \includegraphics[
                            height=5cm
                        ]{data/AD_pet_types_fdg.png}
                    };
                }
                \only<13>{
                    \node[font=\scriptsize\itshape, align=left] at (5.2, -3.5) {
                        "It is necessary to separate syndrome (clinically identified impairment) from biology\\(etiology)\\
                        \\[-0.2cm]
                        \textbf{AD is defined by its biology} with the following implications\\
                        \\[-0.2cm]
                        \textbf{The disease is first evident with the appearance of β-amyloid plaques, and later}\\\textbf{neocortical tau tangles}, while people are asymptomatic. Pathophysiologic mechanisms\\involved with processing and clearance of protein fragments may be involved very early\\in the disease process, but these are not yet well understood.\\
                        \\[-0.2cm]
                        In living people the disease is diagnosed by disease specific core biomarkers\\
                        \\[-0.2cm]
                        Unimpaired individuals with abnormal biomarker testing are at risk for symptoms due to\\AD.\\
                        \\[-0.2cm]
                        They are not at risk for a disease they already have.\\
                        \\[-0.2cm]
                        Symptoms are a result of the disease process and are not necessary to diagnose AD\\
                        \\[-0.2cm]
                        AD exists on a continuum not as discrete clinically defined entities\\
                        \\[-0.2cm]
                        Clinical syndromes commonly seen with AD may also be caused by disorders other than\\AD and therefore clinical presentation alone is not diagnostic of AD\\
                        \\[-0.2cm]
                        The same AD biology may result in different phenotypic presentations"\\
                    };
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                        Revised Criteria for Diagnosis and Staging of Alzheimer's Disease: Alzheimer’s Association Workgroup, alz.org/diagnosticcriteria
                    };
                }

                \only<14>{
                    \node[] at (5, -3.6) {
                        \usebox{\moldempet}
                    };
                }
                \only<15>{
                    \node[] at (5, -3.6) {
                        \usebox{\moldemall}
                    };
                }
                \only<16-17>{
                    \node[font=\tiny, anchor=south,align=center, inner sep=1pt] (ms-citation) at (5, -7.65) {
                        Rogeau, A., Hives, F., Bordier, C., Lahousse, H., Roca, V., Lebouvier, T., ... \& Lopes, R. (2024). A 3D convolutional neural network to\\classify subjects as Alzheimer's disease, frontotemporal dementia or healthy controls using brain 18F-FDG PET. NeuroImage, 120530
                };
                }
                \only<16>{
                    \node[inner sep=0pt, draw=black] at (5, -3.75) {
                        \includegraphics[width=7cm]{data/ad_diff_model.jpg}
                    };
                }
                \only<17>{
                    \node[inner sep=0pt, draw=black] at (5, -3.75) {
                        \includegraphics[width=8cm]{data/ad_diff_results.png}
                    };
                }
            \end{tikzpicture}
        }
        \only<19>{
            \vspace{\summarytop}
            \begin{itemize}[itemsep=\summaryouteritems]
                \item[\textcolor{gray!50}{\textbullet}] {\footnotesize \textcolor{gray!50}{(Non T1-weighted) structural MRI (T2/FLAIR)}}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textcolor{gray!50}{\textbullet}] \textcolor{gray!50}{\scriptsize{Most prevalent in studies classifying MS and PD, yielding high accuracies ($\sim$90\%).}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Intimately linked with MS due to their efficacy at exposing characteristic lesions.}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Potentially more useful than T1-weighted MRI for differentially diagnosing PD and PSP,}}
                    \item[] {\scriptsize \textcolor{gray!50}{as demonstrated by Talai et al.}}
                \end{itemize}
                \item[\textcolor{gray!50}{\textbullet}] {\footnotesize \textcolor{gray!50}{Diffusion MRI}}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Relatively few prediction studies found. Those that exist are for various disorders,}}
                    \item[] {\scriptsize \textcolor{gray!50}{mostly mental disorders (with varying accuracies, 60-100\%) and DEM (80-100\%).}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Used by Saglam et al. to differentially diagnose SCZ and BP with 80\% accuracy.}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Used by Sun et al. to predict conversion from MCI to DEM with 81\% accuracy.}}
                \end{itemize}
                \item[\textcolor{gray!50}{\textbullet}] \textcolor{gray!50}{\footnotesize{Functional MRI}}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Widely used for all conditions, most prominently SCZ and MDD with varying accuracies}}
                    \item[] {\scriptsize \textcolor{gray!50}{(60-100\%) and DEM (80-100\%).}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{Used by Drysdale et al. to characterize MDD biotypes responding differently to MTS.}}
                    \item[\textcolor{gray!50}{\textbullet}] {\scriptsize \textcolor{gray!50}{However, Dinga et al. failed to replicate their results.}}
                \end{itemize}
                \item[\textbullet] {\footnotesize Molecular imaging (PET/SPECT)}
                \begin{itemize}[itemsep=\summaryinneritems]
                    \vspace{\summaryinnertop}
                    \item[\textbullet] {\scriptsize Used in studies classifying PD and DEM with good results (accuracies >90\%).}
                    \item[\textbullet] {\scriptsize PET is excellent for detecting AD-related pathology, both A$\beta$ plaues and TAU tangles.}
                    \item[\textbullet] {\scriptsize SPECT useful to characterize degeneration of dopamine-producing cells in PD, and, as}
                    \item[] {\scriptsize shown by Adams et al., is plausibly useful to predict prognosis.}
                \end{itemize}
            \end{itemize}
        }
    \end{frame}

    \section{The future of neuroimaging-based prediction}

    \newsavebox{\accuracyplots}
    \sbox{\accuracyplots}{%
        \begin{tikzpicture}
            \begin{axis}[
                boxplot/draw direction = y,
                width=10cm,
                height=7cm,
                xmin=0.4,
                xmax=6.6,
                ymin=50,
                ymax=100,
                xtick={1,2,3,4,5,6},
                xticklabels={DEM,MS,PD,SCZ,MDD,BP},
                ylabel=Accuracy,
                axis y line*=left,
                xlabel=Diagnosis,
                axis x line*=bottom,
                clip=false,
                xtick style={draw=none},
                ymajorgrids=true,
                ytick style={draw=none},
            ]
            % DEM
            \addplot[] coordinates { (0.595, 92.5) (1.405, 92.5) };
            \addplot[] coordinates { (1.595, 93.4) (2.405, 93.4) };
            \addplot[] coordinates { (2.595, 95.15) (3.405, 95.15) };
            \addplot[] coordinates { (3.595, 81.8) (4.405, 81.8) };
            \addplot[] coordinates { (4.595, 85) (5.405, 85) };
            \addplot[] coordinates { (5.595, 68.2) (6.405, 68.2) };
            \node[anchor=south] at (axis cs: 1, 92.5) {92.5\%};
            \node[anchor=south] at (axis cs:2, 93.4) {93.4\%};
            \node[anchor=south] at (axis cs:3, 95.15) {95.15\%};
            \node[anchor=south] at (axis cs:4, 81.8) {81.8\%};
            \node[anchor=south] at (axis cs:5, 85) {85\%};
            \node[anchor=south] at (axis cs:6, 68.2) {68.2\%};
            \end{axis}
        \end{tikzpicture}
    }

    \newsavebox{\boxplots}
    \sbox{\boxplots}{%
        \begin{tikzpicture}
            \begin{axis}[
                boxplot/draw direction = y,
                width=10cm,
                height=7cm,
                xmin=0.4,
                xmax=6.6,
                ymin=50,
                ymax=100,
                xtick={1,2,3,4,5,6},
                xticklabels={DEM,MS,PD,SCZ,MDD,BP},
                ylabel=Accuracy,
                axis y line*=left,
                xlabel=Diagnosis,
                axis x line*=bottom,
                clip=false,
                xtick style={draw=none},
                ymajorgrids=true,
                ytick style={draw=none},
            ]
            % DEM
            \addplot[red] coordinates { (0.595, 92.5) (1.405, 92.5) };
            \addplot+[
                boxplot prepared={
                median=92.5,
                upper quartile=97.25,
                lower quartile=88.94,
                upper whisker=100,
                lower whisker=76.46
                },
                draw=black,
                fill=color1,
                solid
            ] coordinates {};

            % MS
            \addplot+[
                boxplot prepared={
                median=93.4,
                upper quartile=98.26,
                lower quartile=87.9,
                upper whisker=100,
                lower whisker=72.36
                },
                draw=black,
                fill=color2,
                solid
            ] coordinates {};

            % PD
            \addplot+[
                boxplot prepared={
                median=95.15,
                upper quartile=97.07,
                lower quartile=89.15,
                upper whisker=100,
                lower whisker=77.26
                },
                draw=black,
                fill=color3,
                solid
            ] coordinates {};

            % SCZ
            \addplot+[
                boxplot prepared={
                median=81.8,
                upper quartile=90.28,
                lower quartile=75,
                upper whisker=100,
                lower whisker=62
                },
                draw=black,
                fill=color4,
                solid
            ] coordinates {};

            % MDD
            \addplot+[
                boxplot prepared={
                median=85,
                upper quartile=91.7,
                lower quartile=73,
                upper whisker=99,
                lower whisker=50.55
                },
                draw=black,
                fill=color5,
                solid
            ] coordinates {};

            % BP
            \addplot+[
                boxplot prepared={
                median=68.2,
                upper quartile=78.59,
                lower quartile=61.03,
                upper whisker=100,
                lower whisker=55.9
                },
                draw=black,
                fill=color6,
                solid
            ] coordinates {};
            \end{axis}
        \end{tikzpicture}
    }

    \newsavebox{\sizeplots}
    \sbox{\sizeplots}{%
        \begin{tikzpicture}
            \begin{groupplot}[
                group style={
                    group size=3 by 2,
                    horizontal sep=0.25cm,
                    group name=plots,
                    vertical sep=1.35cm
                },
                height=3.9cm,
                width=4.4cm,
                ymin=50,
                ymax=100,
                ticklabel style = {font=\footnotesize},
                xmin=0,
                xlabel={\footnotesize{Size}},
                x label style={at={(axis description cs:0.5,-0.15)},anchor=north},
                y label style={at={(axis description cs:-0.15,.5)},anchor=south},
            ]
                \nextgroupplot[
                    ylabel={\footnotesize{Accuracy}},
                    ymajorgrids=true,
                    ytick style={draw=none},
                    xmax=4700
                ]
                    \addplot[
                        color1,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/DEM_accuracy_sample.csv};

                \nextgroupplot[
                    ymajorticks=false,
                    ymajorgrids=true,
                    xmax=1600
                ]
                    \addplot[
                        color2,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/MS_accuracy_sample.csv};

                \nextgroupplot[
                    ymajorticks=false,
                    ymajorgrids=true,
                    xmax=1700
                ]
                    \addplot[
                        color3,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/PD_accuracy_sample.csv};

                \nextgroupplot[
                    ylabel={\footnotesize{Accuracy}},
                    ytick style={draw=none},
                    ymajorgrids=true,
                    xmax=1250
                ]
                    \addplot[
                        color4,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/SCZ_accuracy_sample.csv};

                \nextgroupplot[
                    ymajorticks=false,
                    ymajorgrids=true,
                    xmax=395
                ]
                    \addplot[
                        color5,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/MDD_accuracy_sample.csv};

                \nextgroupplot[
                    ymajorticks=false,
                    ymajorgrids=true,
                    xmax=3300
                ]
                    \addplot[
                        color6,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/BP_accuracy_sample.csv};
                \end{groupplot}
            \node[anchor=south] at (plots c1r1.north) {\textbf{\footnotesize{DEM}}};
            \node[anchor=south] at (plots c2r1.north) {\textbf{\footnotesize{MS}}};
            \node[anchor=south] at (plots c3r1.north) {\textbf{\footnotesize{PD}}};
            \node[anchor=south] at (plots c1r2.north) {\textbf{\footnotesize{SCZ}}};
            \node[anchor=south] at (plots c2r2.north) {\textbf{\footnotesize{MDD}}};
            \node[anchor=south] at (plots c3r2.north) {\textbf{\footnotesize{BP}}};
        \end{tikzpicture}
    }

    \newsavebox{\trendplots}
    \sbox{\trendplots}{%
        \begin{tikzpicture}
            \begin{groupplot}[
                group style={
                    group size=3 by 2,
                    horizontal sep=0.25cm,
                    group name=plots,
                    vertical sep=1.35cm
                },
                height=3.9cm,
                width=4.4cm,
                ymin=50,
                ymax=100,
                ticklabel style = {font=\footnotesize},
                xmin=0,
                xlabel={\footnotesize{Size}},
                x label style={at={(axis description cs:0.5,-0.15)},anchor=north},
                y label style={at={(axis description cs:-0.15,.5)},anchor=south},
            ]
                \nextgroupplot[
                    ylabel={\footnotesize{Accuracy}},
                    ymajorgrids=true,
                    ytick style={draw=none},
                    xmax=4700
                ]
                    \addplot[
                        color1,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/DEM_accuracy_sample.csv};
                    \addplot[black, thick] coordinates {
                        (0, 91.0895) (4700, 91.0895+4500*0.0014)
                    };

                \nextgroupplot[
                    ymajorticks=false,
                    ymajorgrids=true,
                    xmax=1600
                ]
                    \addplot[
                        color2,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/MS_accuracy_sample.csv};
                    \addplot[black, thick] coordinates {
                        (0, 92.5003) (4500, 92.5003+1600*-0.0039)
                    };

                \nextgroupplot[
                    ymajorticks=false,
                    ymajorgrids=true,
                    xmax=1700
                ]
                    \addplot[
                        color3,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/PD_accuracy_sample.csv};
                    \addplot[black, thick] coordinates {
                        (0, 92.9322) (1700, 92.9322+1700*-0.0011)
                    };

                \nextgroupplot[
                    ylabel={\footnotesize{Accuracy}},
                    ytick style={draw=none},
                    ymajorgrids=true,
                    xmax=1250
                ]
                    \addplot[
                        color4,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/SCZ_accuracy_sample.csv};
                    \addplot[black, thick] coordinates {
                        (0, 83.2200) (1700, 83.2200+1250*-0.006)
                    };

                \nextgroupplot[
                    ymajorticks=false,
                    ymajorgrids=true,
                    xmax=395
                ]
                    \addplot[
                        color5,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/MDD_accuracy_sample.csv};
                    \addplot[black, thick] coordinates {
                        (0, 85.7010) (1700, 85.7010+395*-0.055)
                    };

                \nextgroupplot[
                    ymajorticks=false,
                    ymajorgrids=true,
                    xmax=3300
                ]
                    \addplot[
                        color6,
                        only marks,
                        opacity=0.5
                    ] table [
                        x=sample,
                        y=accuracy,
                        col sep=comma
                    ] {data/BP_accuracy_sample.csv};
                    \addplot[black, thick] coordinates {
                        (0, 73.0650) (3300, 73.0650+3300*-0.0052)
                    };
                \end{groupplot}
            \node[anchor=south] at (plots c1r1.north) {\textbf{\footnotesize{DEM}}};
            \node[anchor=south] at (plots c2r1.north) {\textbf{\footnotesize{MS}}};
            \node[anchor=south] at (plots c3r1.north) {\textbf{\footnotesize{PD}}};
            \node[anchor=south] at (plots c1r2.north) {\textbf{\footnotesize{SCZ}}};
            \node[anchor=south] at (plots c2r2.north) {\textbf{\footnotesize{MDD}}};
            \node[anchor=south] at (plots c3r2.north) {\textbf{\footnotesize{BP}}};
        \end{tikzpicture}
    }

    \begin{frame}{Challenges: Predictiveness}
        \begin{tikzpicture}
            \node[] at (0, 0) {};
            \node[] at (10, -7) {};

            \only<1>{
                \node[] at (5, -3.5) {
                    \usebox{\accuracyplots}
                };
            }
            \only<2>{
                \node[] at (5, -3.5) {
                    \usebox{\boxplots}
                };
            }
            \only<3>{
                \node[] at (5, -3.5) {
                    \usebox{\sizeplots}
                };
            }
            \only<4>{
                \node[] at (5, -3.5) {
                    \usebox{\trendplots}
                };
            }
        \end{tikzpicture}
    \end{frame}

    \begin{frame}{Challenges: Generalization}
        \centering
        \begin{tikzpicture}
            \onslide<1->{
                \node[font=\tiny, align=center, anchor=south] at (5, -7.7) {
                    Matsuo, K., Harada, K., Fujita, Y., Okamoto, Y., Ota, M., Narita, H., ... \& Watanabe, Y. (2019). Distinctive neuroanatomical\\substrates for depression in bipolar disorder versus major depressive disorder. Cerebral Cortex, 29(1), 202-214
                };
                \only<1,2>{
                    \node[inner sep=0pt, draw=black, anchor=west] at (2, -3) {
                        \includegraphics[
                            height=6cm
                        ]{data/bp_generalization_before.png}
                    };
                }
                \onslide<3->{
                    \node[inner sep=0pt, draw=black,anchor=west] at (2, -3) {
                        \includegraphics[
                            height=6cm
                        ]{data/bp_generalization.png}
                    };
                }
                \onslide<2->{
                    \node[red] (insample) at (1, -3.66) {88.1\%};
                    \draw[-stealth,red,thick] ($ (insample.east) + (0.63, 0) $) -- (insample);
                }
                \only<4>{
                    \node[red] (outofsample) at (9.06, -5.5) {58.3\%};
                    \draw[-stealth,red,thick] ($ (outofsample.west) - (0.63, 0) $) -- (outofsample);
                }

            }
        \end{tikzpicture}
    \end{frame}

    \newsavebox{\nezer}
    \sbox{\nezer}{%
        \begin{tikzpicture}
            \begin{axis}[
                height=6cm,
                width=8cm,
                xtick={1,2,3,4,5,6,7,8,9},
                xticklabels={H7,H8,H9,H2,H3,H4,H6,H1,H5},
                ymin=0,
                ymax=1,
                xtick pos=left,
                ytick pos=bottom,
                x tick style={draw=none},
                xlabel=Hypothesis,
                ylabel style={align=center},
                ylabel={Fraction of teams reporting\\a significant result}
            ]
                \addplot[
                    only marks,
                    mark=*,
                    mark options={
                        draw=black,
                        fill=color1,
                        opacity=0.8
                    },
                    mark size=2.5pt,
                    error bars/.cd,
                    y dir=both,
                    y explicit,
                ] table [
                    x=id,
                    y=fv,
                    y error plus expr=\thisrow{fv_95u}-\thisrow{fv},
                    y error minus expr=\thisrow{fv}-\thisrow{fv_95l},
                    col sep=comma
                ] {data/botvinik_nezer.csv};
            \end{axis}
        \end{tikzpicture}
    }

    \newsavebox{\single}
    \sbox{\single}{%
        \begin{tikzpicture}
            \begin{axis}[
                xlabel=\footnotesize{Accuracy},
                domain=-4:4, % The range over which to plot
                samples=100, % How many points to sample for smoothness
                ymin=0, % Minimum y-value displayed
                ymax=0.5, % Maximum y-value displayed
                xticklabels={,,}, % Remove x tick labels
                width=7cm,
                height=6cm,
                xmin=-4,
                xmax=4,
                axis x line*=bottom,
                y axis line style={draw=none},
                ymajorticks=false,
                clip=false
            ]
                \draw[very thick, color1] (axis cs: 0, 0.02) -- (axis cs: 0, -0.02);
                \node[anchor=south,color1] at (axis cs: 0, 0.01) {\footnotesize{$x\%$}};
            \end{axis}
        \end{tikzpicture}
    }

    \newsavebox{\normal}
    \sbox{\normal}{%
        \begin{tikzpicture}
            \begin{axis}[
                xlabel=\footnotesize{Accuracy},
                domain=-4:4, % The range over which to plot
                samples=100, % How many points to sample for smoothness
                ymin=0, % Minimum y-value displayed
                ymax=0.5, % Maximum y-value displayed
                xticklabels={,,}, % Remove x tick labels
                width=7cm,
                height=6cm,
                xmin=-4,
                xmax=4,
                axis x line*=bottom,
                y axis line style={draw=none},
                ymajorticks=false,
                clip=false
            ]
                \addplot[draw=none, name path=zero] coordinates {(-4, 0) (4, 0)};
                \addplot[thick, name path=normal] {exp(-x^2/2)/sqrt(2*pi)};
                \addplot[dashed] coordinates {(0, 0.41) (0, -0.01)};
                \tikzfillbetween[of=zero and normal]{color1, opacity=0.5};
                \node[anchor=south,color1] at (axis cs: 0, 0.41) {\footnotesize{$x\%$}};
            \end{axis}
        \end{tikzpicture}
    }

    \newsavebox{\bias}
    \sbox{\bias}{%
        \begin{tikzpicture}
            \begin{axis}[
                xlabel=\footnotesize{Accuracy},
                domain=-4:4, % The range over which to plot
                samples=100, % How many points to sample for smoothness
                ymin=0, % Minimum y-value displayed
                ymax=0.5, % Maximum y-value displayed
                xticklabels={,,}, % Remove x tick labels
                width=7cm,
                height=6cm,
                xmin=-4,
                xmax=4,
                axis x line*=bottom,
                y axis line style={draw=none},
                ymajorticks=false,
                clip=false
            ]
                \addplot[draw=none, name path=zero] coordinates {(2, 0) (4, 0)};
                \addplot[thick] {exp(-x^2/2)/sqrt(2*pi)};
                \addplot[dashed] coordinates {(0, 0.41) (0, -0.01)};
                \addplot [thick, domain=2:4, samples=50, name path=normal] {exp(-x^2/2)/sqrt(2*pi)};
                \tikzfillbetween[of=zero and normal]{color1, opacity=0.5};
                \node[anchor=south,color1] at (axis cs: 0, 0.41) {\footnotesize{$x\%$}};
            \end{axis}
        \end{tikzpicture}
    }

    \begin{frame}[t]{Challenges: Researcher degrees of freedom}
        \centering
        \begin{tikzpicture}
            \def\mriwidth{1.3cm}
            \node[] at (0, 0) {};
            \node[] at (10, -7) {};

            \onslide<1-2>{
                \node[inner sep=0pt, outer sep=0pt] (input) at (1.2, -3.5) {
                    \includegraphics[width=\mriwidth]{data/preprocessing_orig.png}
                };
                \node[align=center,draw=gray,fill=gray!20, inner sep=5pt] (model) at (8.7, -3.5) {Predictive\\model};
                \draw[-stealth] (input) -- (model);
            }

            \onslide<2>{
                \node[inner sep=0pt, outer sep=0pt] (rotated) at (3, -3.5) {
                    \includegraphics[width=\mriwidth]{data/preprocessing_rotated.png}
                };
                \node[inner sep=0pt, outer sep=0pt] (mask) at (4.8, -3.5) {
                    \includegraphics[width=\mriwidth]{data/preprocessing_mask.png}
                };
                \node[inner sep=0pt, outer sep=0pt] (seg) at (6.6, -3.5) {
                    \includegraphics[width=\mriwidth]{data/preprocessing_seg.png}
                };
                \draw[-stealth] (input) -- (rotated);
                \draw[-stealth] (rotated) -- (mask);
                \draw[-stealth] (mask) -- (seg);
            }

            \only<3-4>{
                \node[label=below:{\scriptsize{Adapted from Botvinik-Nezer et al., 2020}}] at (5, -2.7) {
                    \usebox{\nezer}
                };

                \node[font=\tiny, align=center, anchor=south] at (5, -7.65) {
                    Botvinik-Nezer, R., Holzmeister, F., Camerer, C. F., Dreber, A., Huber, J., Johannesson, M., ... \& Rieck, J. R. (2020). Variability\\in the analysis of a single neuroimaging dataset by many teams. Nature, 582(7810), 84-88
                };
            }
            \onslide<4>{
                \node[minimum width=9cm, minimum height=6cm,fill=black!2,opacity=0.85] at (5, -2.7) {};
                \node[fill=none,align=center] at (5, -3) {\textit{"On average across the 9 hypotheses, 20\% of teams reported}\\ \textit{a result that differed from the majority of teams. Given that}\\ \textit{the maximum possible variation is 50\%, the observed fraction}\\ \textit{of 20\% divergent results thus \textbf{falls midway between complete}}\\ \textit{\textbf{consistency across teams and completely random results},}\\ \textit{demonstrating that analytical choices have a major effect on}\\ \textit{reported results."}};
            }
        \end{tikzpicture}
    \end{frame}

    \begin{frame}{Opportunities: Larger datasets}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                xmin=1995,
                xmax=2023,
                ymin=0,
                ymax=3100,
                xlabel=Year,
                ylabel={Sample size},
                set layers,
                mark layer=axis tick labels,
                xtick={2000, 2010, 2020},
                xticklabels={2000, 2010, 2020},
                xtick pos=bottom,
                ytick pos=left,
            ]
                \addplot[
                    only marks,
                    mark=*,
                    mark options={fill=color4},
                    mark size=3pt,
                    opacity=0.5
                ] table [
                    col sep=comma,
                    x=year,
                    y=sample
                ] {data/samples_per_year.csv};
                \addplot[
                    very thick
                ] coordinates {
                    (1995, 60.0)
                    (1996, 77.0)
                    (1997, 45.0)
                    (1998, 66.0)
                    (2001, 39.0)
                    (2002, 67.5)
                    (2004, 131.0)
                    (2005, 100.33)
                    (2006, 40.33)
                    (2007, 81.2)
                    (2008, 93.38)
                    (2009, 101.46)
                    (2010, 54.38)
                    (2011, 212.62)
                    (2012, 121.76)
                    (2013, 128.23)
                    (2014, 186.95)
                    (2015, 221.45)
                    (2016, 202.36)
                    (2017, 327.92)
                    (2018, 477.91)
                    (2019, 514.33)
                    (2020, 356.56)
                    (2021, 312.28)
                    (2022, 367.07)
                };
            \end{axis}
        \end{tikzpicture}
    \end{frame}

    \begin{frame}{Opportunities: Better methods}
        \colorlet{mlcolor}{color1}
        \colorlet{dlcolor}{color2}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                xmin=1995,
                xmax=2023,
                ymin=0,
                xlabel=Year,
                ylabel={Sample size},
                set layers,
                mark layer=axis tick labels,
                xtick pos=bottom,
                ytick pos=left,
                ymax=100,
                xtick={2000, 2010, 2020},
                xticklabels={2000, 2010, 2020}
            ]
                \only<1>{
                    \addplot[
                        only marks,
                        mark=*,
                        mark options={fill=gray},
                        mark size=3pt,
                        opacity=0.5
                    ] table [
                        col sep=comma,
                        x=year,
                        y=accuracy
                    ] {data/ML_accuracies.csv};

                    \addplot[
                        only marks,
                        mark=*,
                        mark options={fill=gray},
                        mark size=3pt,
                        opacity=0.5
                    ] table [
                        col sep=comma,
                        x=year,
                        y=accuracy
                    ] {data/DL_accuracies.csv};
                    \addplot[
                        very thick
                    ] coordinates {
                        (2007, 85.72)
                        (2008, 84.83)
                        (2009, 86.0)
                        (2010, 82.89)
                        (2011, 84.38)
                        (2012, 83.21)
                        (2013, 81.01)
                        (2014, 78.13)
                        (2015, 82.39)
                        (2016, 83.79)
                        (2017, 83.89)
                        (2018, 88.07)
                        (2019, 86.47)
                        (2020, 87.95)
                        (2021, 94.28)
                        (2022, 92.93)
                    };
                }
                \only<2>{
                    \addplot[
                        only marks,
                        mark=*,
                        mark options={fill=mlcolor},
                        mark size=3pt,
                        opacity=0.05
                    ] table [
                        col sep=comma,
                        x=year,
                        y=accuracy
                    ] {data/ML_accuracies.csv};
                    \addplot[
                        very thick,
                        mlcolor
                    ] coordinates {
                        (2007, 85.72)
                        (2008, 84.83)
                        (2009, 86.0)
                        (2010, 83.69)
                        (2011, 84.38)
                        (2012, 83.21)
                        (2013, 80.31)
                        (2014, 76.91)
                        (2015, 81.46)
                        (2016, 78.47)
                        (2017, 79.18)
                        (2018, 82.31)
                        (2019, 83.07)
                        (2020, 83.84)
                        (2021, 92.54)
                        (2022, 92.03)
                    };

                    \addplot[
                        only marks,
                        mark=*,
                        mark options={fill=dlcolor},
                        mark size=3pt,
                        opacity=0.05
                    ] table [
                        col sep=comma,
                        x=year,
                        y=accuracy
                    ] {data/DL_accuracies.csv};
                    \addplot[
                        very thick,
                        dlcolor
                    ] coordinates {
                        (2013, 95.32)
                        (2014, 91.84)
                        (2015, 89.06)
                        (2016, 90.45)
                        (2017, 91.04)
                        (2018, 91.9)
                        (2019, 87.34)
                        (2020, 91.87)
                        (2021, 94.73)
                        (2022, 93.53)
                    };
                }
            \end{axis}
        \end{tikzpicture}
    \end{frame}
    \section{Thank you for your attention!}
\end{document}
